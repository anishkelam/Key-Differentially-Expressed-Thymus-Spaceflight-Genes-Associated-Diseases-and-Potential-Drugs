{"cells":[{"cell_type":"markdown","source":["# **Mission of the bioinformatic tools notebook**\n","\n","You have just trained, tested, and validated classification and regression models to predict the response of retina phenotypes to the gene expression based on RNA-seq .  Some of your models are promising to predict the phenotype based on their performance.  Now we wish to validate your findings by comparing your results with those obtained from traditional statistical bioinformatic tools.  We also wish to intepret your findings by determining the biological significance of those genes that your models identified.\n","\n","Your approach is to use various traditional statistical tools that bioinformaticians use when they analyze the same sort of data (gene expression accompanied by a phenotype).  These tools include [DESeq2](https://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html), [gene set enrichment analysis](https://en.wikipedia.org/wiki/Gene_set_enrichment_analysis), and [pathway enrichment analysis](https://en.wikipedia.org/wiki/Pathway_analysis)."],"metadata":{"id":"2_1woxDHvZg1"},"id":"2_1woxDHvZg1"},{"cell_type":"markdown","source":["# Read in the notebook methods"],"metadata":{"id":"vNzwLSWNexzW"},"id":"vNzwLSWNexzW"},{"cell_type":"code","source":["# install and import the python module for importing a notebook\n","!pip install import_ipynb\n","import import_ipynb"],"metadata":{"id":"QDdJYIsHTWjs","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1725736430878,"user_tz":240,"elapsed":7099,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"1da08ee7-a904-45a4-a425-3b1908460567"},"id":"QDdJYIsHTWjs","execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: import_ipynb in /usr/local/lib/python3.10/dist-packages (0.1.4)\n","Requirement already satisfied: IPython in /usr/local/lib/python3.10/dist-packages (from import_ipynb) (7.34.0)\n","Requirement already satisfied: nbformat in /usr/local/lib/python3.10/dist-packages (from import_ipynb) (5.10.4)\n","Requirement already satisfied: setuptools>=18.5 in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (71.0.4)\n","Requirement already satisfied: jedi>=0.16 in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (0.19.1)\n","Requirement already satisfied: decorator in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (4.4.2)\n","Requirement already satisfied: pickleshare in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (0.7.5)\n","Requirement already satisfied: traitlets>=4.2 in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (5.7.1)\n","Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (3.0.47)\n","Requirement already satisfied: pygments in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (2.16.1)\n","Requirement already satisfied: backcall in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (0.2.0)\n","Requirement already satisfied: matplotlib-inline in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (0.1.7)\n","Requirement already satisfied: pexpect>4.3 in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (4.9.0)\n","Requirement already satisfied: fastjsonschema>=2.15 in /usr/local/lib/python3.10/dist-packages (from nbformat->import_ipynb) (2.20.0)\n","Requirement already satisfied: jsonschema>=2.6 in /usr/local/lib/python3.10/dist-packages (from nbformat->import_ipynb) (4.23.0)\n","Requirement already satisfied: jupyter-core!=5.0.*,>=4.12 in /usr/local/lib/python3.10/dist-packages (from nbformat->import_ipynb) (5.7.2)\n","Requirement already satisfied: parso<0.9.0,>=0.8.3 in /usr/local/lib/python3.10/dist-packages (from jedi>=0.16->IPython->import_ipynb) (0.8.4)\n","Requirement already satisfied: attrs>=22.2.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat->import_ipynb) (24.2.0)\n","Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat->import_ipynb) (2023.12.1)\n","Requirement already satisfied: referencing>=0.28.4 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat->import_ipynb) (0.35.1)\n","Requirement already satisfied: rpds-py>=0.7.1 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat->import_ipynb) (0.20.0)\n","Requirement already satisfied: platformdirs>=2.5 in /usr/local/lib/python3.10/dist-packages (from jupyter-core!=5.0.*,>=4.12->nbformat->import_ipynb) (4.2.2)\n","Requirement already satisfied: ptyprocess>=0.5 in /usr/local/lib/python3.10/dist-packages (from pexpect>4.3->IPython->import_ipynb) (0.7.0)\n","Requirement already satisfied: wcwidth in /usr/local/lib/python3.10/dist-packages (from prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0->IPython->import_ipynb) (0.2.13)\n"]}]},{"cell_type":"code","source":["# mount your google drive to this notebook\n","from google.colab import drive\n","drive.flush_and_unmount()\n","drive.mount(\"mnt\", force_remount=True)"],"metadata":{"id":"2BFgmmNcg91q","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1725736435392,"user_tz":240,"elapsed":4524,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"366c814e-0f77-44a3-9434-6fecb5635921"},"id":"2BFgmmNcg91q","execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at mnt\n"]}]},{"cell_type":"code","source":["# import the \"Copy of methods.ipynb\" from your google drive into this notebook\n","m = __import__(\"mnt/MyDrive/Colab Notebooks/Copy of methods\")"],"metadata":{"id":"zHKKJqxSTb5_","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1725736502000,"user_tz":240,"elapsed":66622,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"8d7e28e3-7d3a-469c-d581-fb88e53c2e5d"},"id":"zHKKJqxSTb5_","execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["importing Jupyter notebook from mnt/MyDrive/Colab Notebooks/Copy of methods.ipynb\n","Requirement already satisfied: scikit-learn in /usr/local/lib/python3.10/dist-packages (1.3.2)\n","Requirement already satisfied: numpy<2.0,>=1.17.3 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (1.26.4)\n","Requirement already satisfied: scipy>=1.5.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (1.13.1)\n","Requirement already satisfied: joblib>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (1.4.2)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (3.5.0)\n","Requirement already satisfied: scanpy in /usr/local/lib/python3.10/dist-packages (1.10.2)\n","Requirement already satisfied: anndata>=0.8 in /usr/local/lib/python3.10/dist-packages (from scanpy) (0.10.9)\n","Requirement already satisfied: h5py>=3.1 in /usr/local/lib/python3.10/dist-packages (from scanpy) (3.11.0)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.10/dist-packages (from scanpy) (1.4.2)\n","Requirement already satisfied: legacy-api-wrap>=1.4 in /usr/local/lib/python3.10/dist-packages (from scanpy) (1.4)\n","Requirement already satisfied: matplotlib>=3.6 in /usr/local/lib/python3.10/dist-packages (from scanpy) (3.7.1)\n","Requirement already satisfied: natsort in /usr/local/lib/python3.10/dist-packages (from scanpy) (8.4.0)\n","Requirement already satisfied: networkx>=2.7 in /usr/local/lib/python3.10/dist-packages (from scanpy) (3.3)\n","Requirement already satisfied: numba>=0.56 in /usr/local/lib/python3.10/dist-packages (from scanpy) (0.60.0)\n","Requirement already satisfied: numpy<2,>=1.23 in /usr/local/lib/python3.10/dist-packages (from scanpy) (1.26.4)\n","Requirement already satisfied: packaging>=21.3 in /usr/local/lib/python3.10/dist-packages (from scanpy) (24.1)\n","Requirement already satisfied: pandas>=1.5 in /usr/local/lib/python3.10/dist-packages (from scanpy) (2.1.4)\n","Requirement already satisfied: patsy in /usr/local/lib/python3.10/dist-packages (from scanpy) (0.5.6)\n","Requirement already satisfied: pynndescent>=0.5 in /usr/local/lib/python3.10/dist-packages (from scanpy) (0.5.13)\n","Requirement already satisfied: scikit-learn>=0.24 in /usr/local/lib/python3.10/dist-packages (from scanpy) (1.3.2)\n","Requirement already satisfied: scipy>=1.8 in /usr/local/lib/python3.10/dist-packages (from scanpy) (1.13.1)\n","Requirement already satisfied: seaborn>=0.13 in /usr/local/lib/python3.10/dist-packages (from scanpy) (0.13.1)\n","Requirement already satisfied: session-info in /usr/local/lib/python3.10/dist-packages (from scanpy) (1.0.0)\n","Requirement already satisfied: statsmodels>=0.13 in /usr/local/lib/python3.10/dist-packages (from scanpy) (0.14.2)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from scanpy) (4.66.5)\n","Requirement already satisfied: umap-learn!=0.5.0,>=0.5 in /usr/local/lib/python3.10/dist-packages (from scanpy) (0.5.6)\n","Requirement already satisfied: array-api-compat!=1.5,>1.4 in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8->scanpy) (1.8)\n","Requirement already satisfied: exceptiongroup in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8->scanpy) (1.2.2)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6->scanpy) (1.3.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6->scanpy) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6->scanpy) (4.53.1)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6->scanpy) (1.4.5)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6->scanpy) (9.4.0)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6->scanpy) (3.1.4)\n","Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6->scanpy) (2.8.2)\n","Requirement already satisfied: llvmlite<0.44,>=0.43.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba>=0.56->scanpy) (0.43.0)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.5->scanpy) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.5->scanpy) (2024.1)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=0.24->scanpy) (3.5.0)\n","Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from patsy->scanpy) (1.16.0)\n","Requirement already satisfied: stdlib-list in /usr/local/lib/python3.10/dist-packages (from session-info->scanpy) (0.10.0)\n","Requirement already satisfied: gseapy in /usr/local/lib/python3.10/dist-packages (1.1.3)\n","Requirement already satisfied: numpy>=1.13.0 in /usr/local/lib/python3.10/dist-packages (from gseapy) (1.26.4)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from gseapy) (1.13.1)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from gseapy) (2.1.4)\n","Requirement already satisfied: matplotlib>=2.2 in /usr/local/lib/python3.10/dist-packages (from gseapy) (3.7.1)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from gseapy) (2.32.3)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (1.3.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (4.53.1)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (1.4.5)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (24.1)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (9.4.0)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (3.1.4)\n","Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->gseapy) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas->gseapy) (2024.1)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->gseapy) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->gseapy) (3.8)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->gseapy) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->gseapy) (2024.8.30)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.7->matplotlib>=2.2->gseapy) (1.16.0)\n","Requirement already satisfied: pydeseq2 in /usr/local/lib/python3.10/dist-packages (0.4.11)\n","Requirement already satisfied: anndata>=0.8.0 in /usr/local/lib/python3.10/dist-packages (from pydeseq2) (0.10.9)\n","Requirement already satisfied: numpy>=1.23.0 in /usr/local/lib/python3.10/dist-packages (from pydeseq2) (1.26.4)\n","Requirement already satisfied: pandas>=1.4.0 in /usr/local/lib/python3.10/dist-packages (from pydeseq2) (2.1.4)\n","Requirement already satisfied: scikit-learn>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from pydeseq2) (1.3.2)\n","Requirement already satisfied: scipy>=1.11.0 in /usr/local/lib/python3.10/dist-packages (from pydeseq2) (1.13.1)\n","Requirement already satisfied: matplotlib>=3.6.2 in /usr/local/lib/python3.10/dist-packages (from pydeseq2) (3.7.1)\n","Requirement already satisfied: array-api-compat!=1.5,>1.4 in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pydeseq2) (1.8)\n","Requirement already satisfied: exceptiongroup in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pydeseq2) (1.2.2)\n","Requirement already satisfied: h5py>=3.1 in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pydeseq2) (3.11.0)\n","Requirement already satisfied: natsort in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pydeseq2) (8.4.0)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pydeseq2) (24.1)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pydeseq2) (1.3.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pydeseq2) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pydeseq2) (4.53.1)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pydeseq2) (1.4.5)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pydeseq2) (9.4.0)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pydeseq2) (3.1.4)\n","Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pydeseq2) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.0->pydeseq2) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.0->pydeseq2) (2024.1)\n","Requirement already satisfied: joblib>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=1.1.0->pydeseq2) (1.4.2)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=1.1.0->pydeseq2) (3.5.0)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.7->matplotlib>=3.6.2->pydeseq2) (1.16.0)\n","Requirement already satisfied: pybiomart==0.1 in /usr/local/lib/python3.10/dist-packages (0.1)\n","Requirement already satisfied: future in /usr/local/lib/python3.10/dist-packages (from pybiomart==0.1) (1.0.0)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from pybiomart==0.1) (2.1.4)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from pybiomart==0.1) (2.32.3)\n","Requirement already satisfied: requests-cache in /usr/local/lib/python3.10/dist-packages (from pybiomart==0.1) (1.2.1)\n","Requirement already satisfied: numpy<2,>=1.22.4 in /usr/local/lib/python3.10/dist-packages (from pandas->pybiomart==0.1) (1.26.4)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas->pybiomart==0.1) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->pybiomart==0.1) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas->pybiomart==0.1) (2024.1)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->pybiomart==0.1) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->pybiomart==0.1) (3.8)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->pybiomart==0.1) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->pybiomart==0.1) (2024.8.30)\n","Requirement already satisfied: attrs>=21.2 in /usr/local/lib/python3.10/dist-packages (from requests-cache->pybiomart==0.1) (24.2.0)\n","Requirement already satisfied: cattrs>=22.2 in /usr/local/lib/python3.10/dist-packages (from requests-cache->pybiomart==0.1) (24.1.0)\n","Requirement already satisfied: platformdirs>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests-cache->pybiomart==0.1) (4.2.2)\n","Requirement already satisfied: url-normalize>=1.4 in /usr/local/lib/python3.10/dist-packages (from requests-cache->pybiomart==0.1) (1.4.3)\n","Requirement already satisfied: exceptiongroup>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from cattrs>=22.2->requests-cache->pybiomart==0.1) (1.2.2)\n","Requirement already satisfied: typing-extensions!=4.6.3,>=4.1.0 in /usr/local/lib/python3.10/dist-packages (from cattrs>=22.2->requests-cache->pybiomart==0.1) (4.12.2)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.2->pandas->pybiomart==0.1) (1.16.0)\n","Requirement already satisfied: mygene in /usr/local/lib/python3.10/dist-packages (3.2.2)\n","Requirement already satisfied: biothings-client>=0.2.6 in /usr/local/lib/python3.10/dist-packages (from mygene) (0.3.1)\n","Requirement already satisfied: requests>=2.3.0 in /usr/local/lib/python3.10/dist-packages (from biothings-client>=0.2.6->mygene) (2.32.3)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (3.8)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (2024.8.30)\n","Requirement already satisfied: sklearn_som in /usr/local/lib/python3.10/dist-packages (1.1.0)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from sklearn_som) (1.26.4)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (2.1.4)\n","Requirement already satisfied: numpy<2,>=1.22.4 in /usr/local/lib/python3.10/dist-packages (from pandas) (1.26.4)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas) (2024.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.2->pandas) (1.16.0)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (1.26.4)\n","Requirement already satisfied: matplotlib in /usr/local/lib/python3.10/dist-packages (3.7.1)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (1.3.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (4.53.1)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (1.4.5)\n","Requirement already satisfied: numpy>=1.20 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (1.26.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (24.1)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (9.4.0)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (3.1.4)\n","Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (2.8.2)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.7->matplotlib) (1.16.0)\n","Requirement already satisfied: sklearn-som in /usr/local/lib/python3.10/dist-packages (1.1.0)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from sklearn-som) (1.26.4)\n","Requirement already satisfied: pyDeseq2 in /usr/local/lib/python3.10/dist-packages (0.4.11)\n","Requirement already satisfied: anndata>=0.8.0 in /usr/local/lib/python3.10/dist-packages (from pyDeseq2) (0.10.9)\n","Requirement already satisfied: numpy>=1.23.0 in /usr/local/lib/python3.10/dist-packages (from pyDeseq2) (1.26.4)\n","Requirement already satisfied: pandas>=1.4.0 in /usr/local/lib/python3.10/dist-packages (from pyDeseq2) (2.1.4)\n","Requirement already satisfied: scikit-learn>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from pyDeseq2) (1.3.2)\n","Requirement already satisfied: scipy>=1.11.0 in /usr/local/lib/python3.10/dist-packages (from pyDeseq2) (1.13.1)\n","Requirement already satisfied: matplotlib>=3.6.2 in /usr/local/lib/python3.10/dist-packages (from pyDeseq2) (3.7.1)\n","Requirement already satisfied: array-api-compat!=1.5,>1.4 in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pyDeseq2) (1.8)\n","Requirement already satisfied: exceptiongroup in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pyDeseq2) (1.2.2)\n","Requirement already satisfied: h5py>=3.1 in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pyDeseq2) (3.11.0)\n","Requirement already satisfied: natsort in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pyDeseq2) (8.4.0)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pyDeseq2) (24.1)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pyDeseq2) (1.3.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pyDeseq2) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pyDeseq2) (4.53.1)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pyDeseq2) (1.4.5)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pyDeseq2) (9.4.0)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pyDeseq2) (3.1.4)\n","Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pyDeseq2) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.0->pyDeseq2) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.0->pyDeseq2) (2024.1)\n","Requirement already satisfied: joblib>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=1.1.0->pyDeseq2) (1.4.2)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=1.1.0->pyDeseq2) (3.5.0)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.7->matplotlib>=3.6.2->pyDeseq2) (1.16.0)\n","Requirement already satisfied: Ensembl_converter in /usr/local/lib/python3.10/dist-packages (0.0.1)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from Ensembl_converter) (1.26.4)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from Ensembl_converter) (2.1.4)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from Ensembl_converter) (4.66.5)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from Ensembl_converter) (2.32.3)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas->Ensembl_converter) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->Ensembl_converter) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas->Ensembl_converter) (2024.1)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->Ensembl_converter) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->Ensembl_converter) (3.8)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->Ensembl_converter) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->Ensembl_converter) (2024.8.30)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.2->pandas->Ensembl_converter) (1.16.0)\n","Requirement already satisfied: mygene in /usr/local/lib/python3.10/dist-packages (3.2.2)\n","Requirement already satisfied: biothings-client>=0.2.6 in /usr/local/lib/python3.10/dist-packages (from mygene) (0.3.1)\n","Requirement already satisfied: requests>=2.3.0 in /usr/local/lib/python3.10/dist-packages (from biothings-client>=0.2.6->mygene) (2.32.3)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (3.8)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (2024.8.30)\n","Requirement already satisfied: shap in /usr/local/lib/python3.10/dist-packages (0.46.0)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from shap) (1.26.4)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from shap) (1.13.1)\n","Requirement already satisfied: scikit-learn in /usr/local/lib/python3.10/dist-packages (from shap) (1.3.2)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from shap) (2.1.4)\n","Requirement already satisfied: tqdm>=4.27.0 in /usr/local/lib/python3.10/dist-packages (from shap) (4.66.5)\n","Requirement already satisfied: packaging>20.9 in /usr/local/lib/python3.10/dist-packages (from shap) (24.1)\n","Requirement already satisfied: slicer==0.0.8 in /usr/local/lib/python3.10/dist-packages (from shap) (0.0.8)\n","Requirement already satisfied: numba in /usr/local/lib/python3.10/dist-packages (from shap) (0.60.0)\n","Requirement already satisfied: cloudpickle in /usr/local/lib/python3.10/dist-packages (from shap) (2.2.1)\n","Requirement already satisfied: llvmlite<0.44,>=0.43.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba->shap) (0.43.0)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas->shap) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->shap) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas->shap) (2024.1)\n","Requirement already satisfied: joblib>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn->shap) (1.4.2)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn->shap) (3.5.0)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.2->pandas->shap) (1.16.0)\n"]}]},{"cell_type":"markdown","source":["# Read in and prepare the data"],"metadata":{"id":"7NHIuKL3fWZv"},"id":"7NHIuKL3fWZv"},{"cell_type":"markdown","source":["## Read in the data from OSD"],"metadata":{"id":"VjT5Zktaw6sm"},"id":"VjT5Zktaw6sm"},{"cell_type":"code","source":["# define dictionaries for data and metadata\n","data=dict()\n","metadata=dict()"],"metadata":{"id":"igHSU7HQiItA","executionInfo":{"status":"ok","timestamp":1725736502002,"user_tz":240,"elapsed":8,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}}},"id":"igHSU7HQiItA","execution_count":4,"outputs":[]},{"cell_type":"code","source":["# use m.read_rnaseq_data() to read in the normalized transcriptomic counts from OSD-423\n","data['423-unormalized'] = m.read_rnaseq_data('423_rna_seq_STAR_Unnormalized_Counts')\n","print('RNA-seq data shape: ', data['423-unormalized'].shape)\n","data['423-unormalized'].head()"],"metadata":{"id":"b7vRTgp3kTtX","colab":{"base_uri":"https://localhost:8080/","height":290},"executionInfo":{"status":"ok","timestamp":1725736503729,"user_tz":240,"elapsed":1734,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"d46988f8-35cc-40f5-d2b6-6a8eaf5805f9"},"id":"b7vRTgp3kTtX","execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["RNA-seq data shape:  (30652, 21)\n"]},{"output_type":"execute_result","data":{"text/plain":["           Unnamed: 0  SLS-2_TMS_FLT_F13_Cut2  SLS-2_TMS_FLT_F14_Cut2  \\\n","0  ENSRNOG00000000001                       6                       0   \n","1  ENSRNOG00000000007                       1                       5   \n","2  ENSRNOG00000000008                       0                       2   \n","3  ENSRNOG00000000009                       0                       0   \n","4  ENSRNOG00000000010                       7                      10   \n","\n","   SLS-2_TMS_FLT_F15_Cut1_LibRep1  SLS-2_TMS_FLT_F15_Cut1_LibRep2  \\\n","0                              12                               0   \n","1                               0                               0   \n","2                               0                               0   \n","3                               0                               0   \n","4                               0                               8   \n","\n","   SLS-2_TMS_FLT_F15_Cut1_LibRep3  SLS-2_TMS_FLT_F15_Cut1_LibRep4  \\\n","0                              17                               0   \n","1                              15                               1   \n","2                               0                               0   \n","3                               0                               2   \n","4                               7                               0   \n","\n","   SLS-2_TMS_FLT_F15_Cut2  SLS-2_TMS_FLT_F16_Cut2  SLS-2_TMS_FLT_F17_Cut2  \\\n","0                      12                       0                       0   \n","1                       0                       0                       0   \n","2                       0                       0                       0   \n","3                       0                       0                       0   \n","4                      41                       2                       0   \n","\n","   ...  SLS-2_TMS_GC_G10_Cut2  SLS-2_TMS_GC_G11_Cut2  \\\n","0  ...                     13                      0   \n","1  ...                      0                      0   \n","2  ...                      0                      0   \n","3  ...                      0                      0   \n","4  ...                     25                      0   \n","\n","   SLS-2_TMS_GC_G12_Cut1_LibRep1  SLS-2_TMS_GC_G12_Cut1_LibRep2  \\\n","0                              0                              0   \n","1                              0                              0   \n","2                              0                              0   \n","3                              0                              0   \n","4                              6                             13   \n","\n","   SLS-2_TMS_GC_G12_Cut1_LibRep3  SLS-2_TMS_GC_G12_Cut1_LibRep4  \\\n","0                              0                              0   \n","1                              0                              0   \n","2                              0                              0   \n","3                              0                              0   \n","4                             11                              1   \n","\n","   SLS-2_TMS_GC_G12_Cut2  SLS-2_TMS_GC_G22_Cut2  SLS-2_TMS_GC_G23_Cut2  \\\n","0                     23                     14                     22   \n","1                      0                      1                      6   \n","2                      0                      0                      0   \n","3                      3                      0                      0   \n","4                     18                     36                     32   \n","\n","   SLS-2_TMS_GC_G24_Cut2  \n","0                     15  \n","1                      0  \n","2                      0  \n","3                      0  \n","4                      2  \n","\n","[5 rows x 21 columns]"],"text/html":["\n","  <div id=\"df-e6ed559c-ef00-454a-9dbc-bc965575dce0\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>SLS-2_TMS_FLT_F13_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F14_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F15_Cut1_LibRep1</th>\n","      <th>SLS-2_TMS_FLT_F15_Cut1_LibRep2</th>\n","      <th>SLS-2_TMS_FLT_F15_Cut1_LibRep3</th>\n","      <th>SLS-2_TMS_FLT_F15_Cut1_LibRep4</th>\n","      <th>SLS-2_TMS_FLT_F15_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F16_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F17_Cut2</th>\n","      <th>...</th>\n","      <th>SLS-2_TMS_GC_G10_Cut2</th>\n","      <th>SLS-2_TMS_GC_G11_Cut2</th>\n","      <th>SLS-2_TMS_GC_G12_Cut1_LibRep1</th>\n","      <th>SLS-2_TMS_GC_G12_Cut1_LibRep2</th>\n","      <th>SLS-2_TMS_GC_G12_Cut1_LibRep3</th>\n","      <th>SLS-2_TMS_GC_G12_Cut1_LibRep4</th>\n","      <th>SLS-2_TMS_GC_G12_Cut2</th>\n","      <th>SLS-2_TMS_GC_G22_Cut2</th>\n","      <th>SLS-2_TMS_GC_G23_Cut2</th>\n","      <th>SLS-2_TMS_GC_G24_Cut2</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ENSRNOG00000000001</td>\n","      <td>6</td>\n","      <td>0</td>\n","      <td>12</td>\n","      <td>0</td>\n","      <td>17</td>\n","      <td>0</td>\n","      <td>12</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>13</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>23</td>\n","      <td>14</td>\n","      <td>22</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ENSRNOG00000000007</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>15</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>6</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ENSRNOG00000000008</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ENSRNOG00000000009</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ENSRNOG00000000010</td>\n","      <td>7</td>\n","      <td>10</td>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>7</td>\n","      <td>0</td>\n","      <td>41</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>25</td>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>13</td>\n","      <td>11</td>\n","      <td>1</td>\n","      <td>18</td>\n","      <td>36</td>\n","      <td>32</td>\n","      <td>2</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows Ã— 21 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e6ed559c-ef00-454a-9dbc-bc965575dce0')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-e6ed559c-ef00-454a-9dbc-bc965575dce0 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-e6ed559c-ef00-454a-9dbc-bc965575dce0');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-16141bb0-bde6-4524-b962-ea1b528b2d55\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-16141bb0-bde6-4524-b962-ea1b528b2d55')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-16141bb0-bde6-4524-b962-ea1b528b2d55 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe"}},"metadata":{},"execution_count":5}]},{"cell_type":"code","source":["metadata['423'] = m.pd.read_csv('mnt/My Drive/Colab Notebooks/Capstone/s_OSD-423.txt', sep='\\t', header=0)\n","print(metadata['423'])"],"metadata":{"id":"r3bmibxgfsDN","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1725737606700,"user_tz":240,"elapsed":165,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"c039d655-45bc-4cf1-c5ae-f67a0a66423e"},"id":"r3bmibxgfsDN","execution_count":25,"outputs":[{"output_type":"stream","name":"stdout","text":["    Source Name                     Sample Name Characteristics[Organism]  \\\n","0           262          SLS-2_TMS_FLT_F13_Cut2         Rattus norvegicus   \n","1           305          SLS-2_TMS_FLT_F14_Cut2         Rattus norvegicus   \n","2           282  SLS-2_TMS_FLT_F15_Cut1_LibRep1         Rattus norvegicus   \n","3           282  SLS-2_TMS_FLT_F15_Cut1_LibRep2         Rattus norvegicus   \n","4           282  SLS-2_TMS_FLT_F15_Cut1_LibRep3         Rattus norvegicus   \n","5           282  SLS-2_TMS_FLT_F15_Cut1_LibRep4         Rattus norvegicus   \n","6           282          SLS-2_TMS_FLT_F15_Cut2         Rattus norvegicus   \n","7           307          SLS-2_TMS_FLT_F16_Cut2         Rattus norvegicus   \n","8           290          SLS-2_TMS_FLT_F17_Cut2         Rattus norvegicus   \n","9           294          SLS-2_TMS_FLT_F18_Cut2         Rattus norvegicus   \n","10          261           SLS-2_TMS_GC_G10_Cut2         Rattus norvegicus   \n","11          278           SLS-2_TMS_GC_G11_Cut2         Rattus norvegicus   \n","12          274   SLS-2_TMS_GC_G12_Cut1_LibRep1         Rattus norvegicus   \n","13          274   SLS-2_TMS_GC_G12_Cut1_LibRep2         Rattus norvegicus   \n","14          274   SLS-2_TMS_GC_G12_Cut1_LibRep3         Rattus norvegicus   \n","15          274   SLS-2_TMS_GC_G12_Cut1_LibRep4         Rattus norvegicus   \n","16          274           SLS-2_TMS_GC_G12_Cut2         Rattus norvegicus   \n","17          276           SLS-2_TMS_GC_G22_Cut2         Rattus norvegicus   \n","18          287           SLS-2_TMS_GC_G23_Cut2         Rattus norvegicus   \n","19          297           SLS-2_TMS_GC_G24_Cut2         Rattus norvegicus   \n","\n","   Term Source REF                              Term Accession Number  \\\n","0        NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","1        NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","2        NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","3        NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","4        NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","5        NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","6        NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","7        NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","8        NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","9        NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","10       NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","11       NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","12       NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","13       NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","14       NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","15       NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","16       NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","17       NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","18       NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","19       NCBITAXON  http://purl.bioontology.org/ontology/NCBITAXON...   \n","\n","   Characteristics[Strain] Term Source REF.1  \\\n","0     Rats, Sprague-Dawley              MESH   \n","1     Rats, Sprague-Dawley              MESH   \n","2     Rats, Sprague-Dawley              MESH   \n","3     Rats, Sprague-Dawley              MESH   \n","4     Rats, Sprague-Dawley              MESH   \n","5     Rats, Sprague-Dawley              MESH   \n","6     Rats, Sprague-Dawley              MESH   \n","7     Rats, Sprague-Dawley              MESH   \n","8     Rats, Sprague-Dawley              MESH   \n","9     Rats, Sprague-Dawley              MESH   \n","10    Rats, Sprague-Dawley              MESH   \n","11    Rats, Sprague-Dawley              MESH   \n","12    Rats, Sprague-Dawley              MESH   \n","13    Rats, Sprague-Dawley              MESH   \n","14    Rats, Sprague-Dawley              MESH   \n","15    Rats, Sprague-Dawley              MESH   \n","16    Rats, Sprague-Dawley              MESH   \n","17    Rats, Sprague-Dawley              MESH   \n","18    Rats, Sprague-Dawley              MESH   \n","19    Rats, Sprague-Dawley              MESH   \n","\n","                              Term Accession Number.1  \\\n","0   http://purl.bioontology.org/ontology/MESH/D017207   \n","1   http://purl.bioontology.org/ontology/MESH/D017207   \n","2   http://purl.bioontology.org/ontology/MESH/D017207   \n","3   http://purl.bioontology.org/ontology/MESH/D017207   \n","4   http://purl.bioontology.org/ontology/MESH/D017207   \n","5   http://purl.bioontology.org/ontology/MESH/D017207   \n","6   http://purl.bioontology.org/ontology/MESH/D017207   \n","7   http://purl.bioontology.org/ontology/MESH/D017207   \n","8   http://purl.bioontology.org/ontology/MESH/D017207   \n","9   http://purl.bioontology.org/ontology/MESH/D017207   \n","10  http://purl.bioontology.org/ontology/MESH/D017207   \n","11  http://purl.bioontology.org/ontology/MESH/D017207   \n","12  http://purl.bioontology.org/ontology/MESH/D017207   \n","13  http://purl.bioontology.org/ontology/MESH/D017207   \n","14  http://purl.bioontology.org/ontology/MESH/D017207   \n","15  http://purl.bioontology.org/ontology/MESH/D017207   \n","16  http://purl.bioontology.org/ontology/MESH/D017207   \n","17  http://purl.bioontology.org/ontology/MESH/D017207   \n","18  http://purl.bioontology.org/ontology/MESH/D017207   \n","19  http://purl.bioontology.org/ontology/MESH/D017207   \n","\n","   Characteristics[Animal Source] Characteristics[sex]  ... Term Source REF.9  \\\n","0             Taconic Biosciences                 male  ...              NCIT   \n","1             Taconic Biosciences                 male  ...              NCIT   \n","2             Taconic Biosciences                 male  ...              NCIT   \n","3             Taconic Biosciences                 male  ...              NCIT   \n","4             Taconic Biosciences                 male  ...              NCIT   \n","5             Taconic Biosciences                 male  ...              NCIT   \n","6             Taconic Biosciences                 male  ...              NCIT   \n","7             Taconic Biosciences                 male  ...              NCIT   \n","8             Taconic Biosciences                 male  ...              NCIT   \n","9             Taconic Biosciences                 male  ...              NCIT   \n","10            Taconic Biosciences                 male  ...              NCIT   \n","11            Taconic Biosciences                 male  ...              NCIT   \n","12            Taconic Biosciences                 male  ...              NCIT   \n","13            Taconic Biosciences                 male  ...              NCIT   \n","14            Taconic Biosciences                 male  ...              NCIT   \n","15            Taconic Biosciences                 male  ...              NCIT   \n","16            Taconic Biosciences                 male  ...              NCIT   \n","17            Taconic Biosciences                 male  ...              NCIT   \n","18            Taconic Biosciences                 male  ...              NCIT   \n","19            Taconic Biosciences                 male  ...              NCIT   \n","\n","                       Term Accession Number.9  \\\n","0   http://purl.obolibrary.org/obo/NCIT_C68796   \n","1   http://purl.obolibrary.org/obo/NCIT_C68796   \n","2   http://purl.obolibrary.org/obo/NCIT_C68796   \n","3   http://purl.obolibrary.org/obo/NCIT_C68796   \n","4   http://purl.obolibrary.org/obo/NCIT_C68796   \n","5   http://purl.obolibrary.org/obo/NCIT_C68796   \n","6   http://purl.obolibrary.org/obo/NCIT_C68796   \n","7   http://purl.obolibrary.org/obo/NCIT_C68796   \n","8   http://purl.obolibrary.org/obo/NCIT_C68796   \n","9   http://purl.obolibrary.org/obo/NCIT_C68796   \n","10  http://purl.obolibrary.org/obo/NCIT_C68796   \n","11  http://purl.obolibrary.org/obo/NCIT_C68796   \n","12  http://purl.obolibrary.org/obo/NCIT_C68796   \n","13  http://purl.obolibrary.org/obo/NCIT_C68796   \n","14  http://purl.obolibrary.org/obo/NCIT_C68796   \n","15  http://purl.obolibrary.org/obo/NCIT_C68796   \n","16  http://purl.obolibrary.org/obo/NCIT_C68796   \n","17  http://purl.obolibrary.org/obo/NCIT_C68796   \n","18  http://purl.obolibrary.org/obo/NCIT_C68796   \n","19  http://purl.obolibrary.org/obo/NCIT_C68796   \n","\n","   Parameter Value[Sample Storage Temperature]          Unit.3  \\\n","0                                          -70  degree Celsius   \n","1                                          -70  degree Celsius   \n","2                                          -70  degree Celsius   \n","3                                          -70  degree Celsius   \n","4                                          -70  degree Celsius   \n","5                                          -70  degree Celsius   \n","6                                          -70  degree Celsius   \n","7                                          -70  degree Celsius   \n","8                                          -70  degree Celsius   \n","9                                          -70  degree Celsius   \n","10                                         -70  degree Celsius   \n","11                                         -70  degree Celsius   \n","12                                         -70  degree Celsius   \n","13                                         -70  degree Celsius   \n","14                                         -70  degree Celsius   \n","15                                         -70  degree Celsius   \n","16                                         -70  degree Celsius   \n","17                                         -70  degree Celsius   \n","18                                         -70  degree Celsius   \n","19                                         -70  degree Celsius   \n","\n","   Term Source REF.10                   Term Accession Number.10  \\\n","0                  UO  http://purl.obolibrary.org/obo/UO_0000027   \n","1                  UO  http://purl.obolibrary.org/obo/UO_0000027   \n","2                  UO  http://purl.obolibrary.org/obo/UO_0000027   \n","3                  UO  http://purl.obolibrary.org/obo/UO_0000027   \n","4                  UO  http://purl.obolibrary.org/obo/UO_0000027   \n","5                  UO  http://purl.obolibrary.org/obo/UO_0000027   \n","6                  UO  http://purl.obolibrary.org/obo/UO_0000027   \n","7                  UO  http://purl.obolibrary.org/obo/UO_0000027   \n","8                  UO  http://purl.obolibrary.org/obo/UO_0000027   \n","9                  UO  http://purl.obolibrary.org/obo/UO_0000027   \n","10                 UO  http://purl.obolibrary.org/obo/UO_0000027   \n","11                 UO  http://purl.obolibrary.org/obo/UO_0000027   \n","12                 UO  http://purl.obolibrary.org/obo/UO_0000027   \n","13                 UO  http://purl.obolibrary.org/obo/UO_0000027   \n","14                 UO  http://purl.obolibrary.org/obo/UO_0000027   \n","15                 UO  http://purl.obolibrary.org/obo/UO_0000027   \n","16                 UO  http://purl.obolibrary.org/obo/UO_0000027   \n","17                 UO  http://purl.obolibrary.org/obo/UO_0000027   \n","18                 UO  http://purl.obolibrary.org/obo/UO_0000027   \n","19                 UO  http://purl.obolibrary.org/obo/UO_0000027   \n","\n","   Comment[ALSDA Biospecimen Subject ID] Comment[ALSDA Biospecimen Source ID]  \\\n","0                                    240                                 2275   \n","1                                    240                                 2275   \n","2                                    240                                 2275   \n","3                                    240                                 2275   \n","4                                    240                                 2275   \n","5                                    240                                 2275   \n","6                                    240                                 2275   \n","7                                    240                                 2275   \n","8                                    240                                 2275   \n","9                                    240                                 2275   \n","10                                   239                                 2432   \n","11                                   239                                 2432   \n","12                                   239                                 2432   \n","13                                   239                                 2432   \n","14                                   239                                 2432   \n","15                                   239                                 2432   \n","16                                   239                                 2432   \n","17                                   236                                 2432   \n","18                                   236                                 2432   \n","19                                   236                                 2432   \n","\n","   Comment[ALSDA Source Name]  \\\n","0                Thymus-Rep 2   \n","1                Thymus-Rep 2   \n","2                Thymus-Rep 1   \n","3                Thymus-Rep 1   \n","4                Thymus-Rep 1   \n","5                Thymus-Rep 1   \n","6                Thymus-Rep 2   \n","7                Thymus-Rep 2   \n","8                Thymus-Rep 2   \n","9                Thymus-Rep 2   \n","10               Thymus-Rep 2   \n","11               Thymus-Rep 2   \n","12               Thymus-Rep 1   \n","13               Thymus-Rep 1   \n","14               Thymus-Rep 1   \n","15               Thymus-Rep 1   \n","16               Thymus-Rep 2   \n","17               Thymus-Rep 2   \n","18               Thymus-Rep 2   \n","19               Thymus-Rep 2   \n","\n","   Comment[Euthanasia and Dissection Date (mm/dd/yyyy)]  \n","0                                          11/01/1993    \n","1                                          11/01/1993    \n","2                                          11/01/1993    \n","3                                          11/01/1993    \n","4                                          11/01/1993    \n","5                                          11/01/1993    \n","6                                          11/01/1993    \n","7                                          11/01/1993    \n","8                                          11/01/1993    \n","9                                          11/01/1993    \n","10                                         11/01/1993    \n","11                                         11/01/1993    \n","12                                         11/01/1993    \n","13                                         11/01/1993    \n","14                                         11/01/1993    \n","15                                         11/01/1993    \n","16                                         11/01/1993    \n","17                                         11/01/1993    \n","18                                         11/01/1993    \n","19                                         11/01/1993    \n","\n","[20 rows x 49 columns]\n"]}]},{"cell_type":"markdown","source":["## Filter data"],"metadata":{"id":"PBSIAKdIfjmD"},"id":"PBSIAKdIfjmD"},{"cell_type":"code","source":["# filter out non-protein coding genes and genes with NaN values\n","print('shape before filtering: ', data['423-unormalized'].shape)\n","rna_seq = m.filter_data(data['423-unormalized'], dropnans=True, dropgenes=None, droplowcvs=0, droplowcount=10)\n","print('shape after filtering: ', rna_seq.shape)\n","rna_seq.head()"],"metadata":{"id":"a8Dn9Svor6J-","colab":{"base_uri":"https://localhost:8080/","height":325},"executionInfo":{"status":"ok","timestamp":1725737620422,"user_tz":240,"elapsed":382,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"c91a368e-f57a-4f22-da76-235431fda158"},"id":"a8Dn9Svor6J-","execution_count":26,"outputs":[{"output_type":"stream","name":"stdout","text":["shape before filtering:  (30652, 21)\n","30652\n","shape after filtering:  (19627, 21)\n"]},{"output_type":"execute_result","data":{"text/plain":["           Unnamed: 0  SLS-2_TMS_FLT_F13_Cut2  SLS-2_TMS_FLT_F14_Cut2  \\\n","0  ENSRNOG00000000001                       6                       0   \n","1  ENSRNOG00000000007                       1                       5   \n","4  ENSRNOG00000000010                       7                      10   \n","5  ENSRNOG00000000012                      92                      44   \n","6  ENSRNOG00000000017                       9                       1   \n","\n","   SLS-2_TMS_FLT_F15_Cut1_LibRep1  SLS-2_TMS_FLT_F15_Cut1_LibRep2  \\\n","0                              12                               0   \n","1                               0                               0   \n","4                               0                               8   \n","5                              19                              11   \n","6                               0                               0   \n","\n","   SLS-2_TMS_FLT_F15_Cut1_LibRep3  SLS-2_TMS_FLT_F15_Cut1_LibRep4  \\\n","0                              17                               0   \n","1                              15                               1   \n","4                               7                               0   \n","5                              32                              56   \n","6                              11                              11   \n","\n","   SLS-2_TMS_FLT_F15_Cut2  SLS-2_TMS_FLT_F16_Cut2  SLS-2_TMS_FLT_F17_Cut2  \\\n","0                      12                       0                       0   \n","1                       0                       0                       0   \n","4                      41                       2                       0   \n","5                      48                       0                      11   \n","6                       5                       0                       3   \n","\n","   ...  SLS-2_TMS_GC_G10_Cut2  SLS-2_TMS_GC_G11_Cut2  \\\n","0  ...                     13                      0   \n","1  ...                      0                      0   \n","4  ...                     25                      0   \n","5  ...                     39                     13   \n","6  ...                      5                      0   \n","\n","   SLS-2_TMS_GC_G12_Cut1_LibRep1  SLS-2_TMS_GC_G12_Cut1_LibRep2  \\\n","0                              0                              0   \n","1                              0                              0   \n","4                              6                             13   \n","5                             20                             18   \n","6                              0                              0   \n","\n","   SLS-2_TMS_GC_G12_Cut1_LibRep3  SLS-2_TMS_GC_G12_Cut1_LibRep4  \\\n","0                              0                              0   \n","1                              0                              0   \n","4                             11                              1   \n","5                              9                             31   \n","6                              0                              0   \n","\n","   SLS-2_TMS_GC_G12_Cut2  SLS-2_TMS_GC_G22_Cut2  SLS-2_TMS_GC_G23_Cut2  \\\n","0                     23                     14                     22   \n","1                      0                      1                      6   \n","4                     18                     36                     32   \n","5                    110                    114                    133   \n","6                     12                     17                      7   \n","\n","   SLS-2_TMS_GC_G24_Cut2  \n","0                     15  \n","1                      0  \n","4                      2  \n","5                     29  \n","6                      0  \n","\n","[5 rows x 21 columns]"],"text/html":["\n","  <div id=\"df-543dc2ea-a693-422e-b372-47233985fc4a\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>SLS-2_TMS_FLT_F13_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F14_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F15_Cut1_LibRep1</th>\n","      <th>SLS-2_TMS_FLT_F15_Cut1_LibRep2</th>\n","      <th>SLS-2_TMS_FLT_F15_Cut1_LibRep3</th>\n","      <th>SLS-2_TMS_FLT_F15_Cut1_LibRep4</th>\n","      <th>SLS-2_TMS_FLT_F15_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F16_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F17_Cut2</th>\n","      <th>...</th>\n","      <th>SLS-2_TMS_GC_G10_Cut2</th>\n","      <th>SLS-2_TMS_GC_G11_Cut2</th>\n","      <th>SLS-2_TMS_GC_G12_Cut1_LibRep1</th>\n","      <th>SLS-2_TMS_GC_G12_Cut1_LibRep2</th>\n","      <th>SLS-2_TMS_GC_G12_Cut1_LibRep3</th>\n","      <th>SLS-2_TMS_GC_G12_Cut1_LibRep4</th>\n","      <th>SLS-2_TMS_GC_G12_Cut2</th>\n","      <th>SLS-2_TMS_GC_G22_Cut2</th>\n","      <th>SLS-2_TMS_GC_G23_Cut2</th>\n","      <th>SLS-2_TMS_GC_G24_Cut2</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ENSRNOG00000000001</td>\n","      <td>6</td>\n","      <td>0</td>\n","      <td>12</td>\n","      <td>0</td>\n","      <td>17</td>\n","      <td>0</td>\n","      <td>12</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>13</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>23</td>\n","      <td>14</td>\n","      <td>22</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ENSRNOG00000000007</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>15</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>6</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ENSRNOG00000000010</td>\n","      <td>7</td>\n","      <td>10</td>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>7</td>\n","      <td>0</td>\n","      <td>41</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>25</td>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>13</td>\n","      <td>11</td>\n","      <td>1</td>\n","      <td>18</td>\n","      <td>36</td>\n","      <td>32</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>ENSRNOG00000000012</td>\n","      <td>92</td>\n","      <td>44</td>\n","      <td>19</td>\n","      <td>11</td>\n","      <td>32</td>\n","      <td>56</td>\n","      <td>48</td>\n","      <td>0</td>\n","      <td>11</td>\n","      <td>...</td>\n","      <td>39</td>\n","      <td>13</td>\n","      <td>20</td>\n","      <td>18</td>\n","      <td>9</td>\n","      <td>31</td>\n","      <td>110</td>\n","      <td>114</td>\n","      <td>133</td>\n","      <td>29</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>ENSRNOG00000000017</td>\n","      <td>9</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>11</td>\n","      <td>11</td>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>3</td>\n","      <td>...</td>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>12</td>\n","      <td>17</td>\n","      <td>7</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows Ã— 21 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-543dc2ea-a693-422e-b372-47233985fc4a')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-543dc2ea-a693-422e-b372-47233985fc4a button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-543dc2ea-a693-422e-b372-47233985fc4a');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-83edaab0-33af-411b-8038-899be5aa2000\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-83edaab0-33af-411b-8038-899be5aa2000')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-83edaab0-33af-411b-8038-899be5aa2000 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"rna_seq"}},"metadata":{},"execution_count":26}]},{"cell_type":"code","source":["print('shape before transpose: ', rna_seq.shape)\n","rna_seq = m.transpose_df(rna_seq, cur_index_col='Unnamed: 0', new_index_col = 'sample')\n","print('shape after transpose: ', rna_seq.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"h0cwz-Vbs7v1","executionInfo":{"status":"ok","timestamp":1725737623872,"user_tz":240,"elapsed":185,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"258a6e38-67f9-4ce1-df97-4f4ff369d55f"},"id":"h0cwz-Vbs7v1","execution_count":27,"outputs":[{"output_type":"stream","name":"stdout","text":["shape before transpose:  (19627, 21)\n","shape after transpose:  (20, 19628)\n"]}]},{"cell_type":"code","source":["rna_seq.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":325},"id":"KsIRXTXEs-qM","executionInfo":{"status":"ok","timestamp":1725737641831,"user_tz":240,"elapsed":180,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"a1799e66-6485-4ce4-f758-c73eb5c1ff31"},"id":"KsIRXTXEs-qM","execution_count":28,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                           sample  ENSRNOG00000000001  ENSRNOG00000000007  \\\n","0          SLS-2_TMS_FLT_F13_Cut2                   6                   1   \n","1          SLS-2_TMS_FLT_F14_Cut2                   0                   5   \n","2  SLS-2_TMS_FLT_F15_Cut1_LibRep1                  12                   0   \n","3  SLS-2_TMS_FLT_F15_Cut1_LibRep2                   0                   0   \n","4  SLS-2_TMS_FLT_F15_Cut1_LibRep3                  17                  15   \n","\n","   ENSRNOG00000000010  ENSRNOG00000000012  ENSRNOG00000000017  \\\n","0                   7                  92                   9   \n","1                  10                  44                   1   \n","2                   0                  19                   0   \n","3                   8                  11                   0   \n","4                   7                  32                  11   \n","\n","   ENSRNOG00000000021  ENSRNOG00000000024  ENSRNOG00000000033  \\\n","0                   0                 376                   6   \n","1                   5                 226                  14   \n","2                   6                 123                   6   \n","3                   0                  91                   0   \n","4                   0                 170                   9   \n","\n","   ENSRNOG00000000034  ...  ERCC-00157  ERCC-00158  ERCC-00160  ERCC-00162  \\\n","0                  50  ...         410          21         713        1197   \n","1                   6  ...          65           5         383         964   \n","2                   0  ...          84          10         205         440   \n","3                   7  ...          93          16         103         330   \n","4                   2  ...         137          16         202         624   \n","\n","   ERCC-00163  ERCC-00164  ERCC-00165  ERCC-00168  ERCC-00170  ERCC-00171  \n","0        1177          51        3059          53         446      139278  \n","1         808          46        1731          22         329       90587  \n","2         325           5         895           0         101       39846  \n","3         344          13         652           0         124       39121  \n","4         583          22        1219          15         105       63628  \n","\n","[5 rows x 19628 columns]"],"text/html":["\n","  <div id=\"df-68d133bb-6592-4948-9735-a826f081ae02\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>sample</th>\n","      <th>ENSRNOG00000000001</th>\n","      <th>ENSRNOG00000000007</th>\n","      <th>ENSRNOG00000000010</th>\n","      <th>ENSRNOG00000000012</th>\n","      <th>ENSRNOG00000000017</th>\n","      <th>ENSRNOG00000000021</th>\n","      <th>ENSRNOG00000000024</th>\n","      <th>ENSRNOG00000000033</th>\n","      <th>ENSRNOG00000000034</th>\n","      <th>...</th>\n","      <th>ERCC-00157</th>\n","      <th>ERCC-00158</th>\n","      <th>ERCC-00160</th>\n","      <th>ERCC-00162</th>\n","      <th>ERCC-00163</th>\n","      <th>ERCC-00164</th>\n","      <th>ERCC-00165</th>\n","      <th>ERCC-00168</th>\n","      <th>ERCC-00170</th>\n","      <th>ERCC-00171</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>SLS-2_TMS_FLT_F13_Cut2</td>\n","      <td>6</td>\n","      <td>1</td>\n","      <td>7</td>\n","      <td>92</td>\n","      <td>9</td>\n","      <td>0</td>\n","      <td>376</td>\n","      <td>6</td>\n","      <td>50</td>\n","      <td>...</td>\n","      <td>410</td>\n","      <td>21</td>\n","      <td>713</td>\n","      <td>1197</td>\n","      <td>1177</td>\n","      <td>51</td>\n","      <td>3059</td>\n","      <td>53</td>\n","      <td>446</td>\n","      <td>139278</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>SLS-2_TMS_FLT_F14_Cut2</td>\n","      <td>0</td>\n","      <td>5</td>\n","      <td>10</td>\n","      <td>44</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>226</td>\n","      <td>14</td>\n","      <td>6</td>\n","      <td>...</td>\n","      <td>65</td>\n","      <td>5</td>\n","      <td>383</td>\n","      <td>964</td>\n","      <td>808</td>\n","      <td>46</td>\n","      <td>1731</td>\n","      <td>22</td>\n","      <td>329</td>\n","      <td>90587</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>SLS-2_TMS_FLT_F15_Cut1_LibRep1</td>\n","      <td>12</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>19</td>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>123</td>\n","      <td>6</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>84</td>\n","      <td>10</td>\n","      <td>205</td>\n","      <td>440</td>\n","      <td>325</td>\n","      <td>5</td>\n","      <td>895</td>\n","      <td>0</td>\n","      <td>101</td>\n","      <td>39846</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>SLS-2_TMS_FLT_F15_Cut1_LibRep2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>11</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>91</td>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>...</td>\n","      <td>93</td>\n","      <td>16</td>\n","      <td>103</td>\n","      <td>330</td>\n","      <td>344</td>\n","      <td>13</td>\n","      <td>652</td>\n","      <td>0</td>\n","      <td>124</td>\n","      <td>39121</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>SLS-2_TMS_FLT_F15_Cut1_LibRep3</td>\n","      <td>17</td>\n","      <td>15</td>\n","      <td>7</td>\n","      <td>32</td>\n","      <td>11</td>\n","      <td>0</td>\n","      <td>170</td>\n","      <td>9</td>\n","      <td>2</td>\n","      <td>...</td>\n","      <td>137</td>\n","      <td>16</td>\n","      <td>202</td>\n","      <td>624</td>\n","      <td>583</td>\n","      <td>22</td>\n","      <td>1219</td>\n","      <td>15</td>\n","      <td>105</td>\n","      <td>63628</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows Ã— 19628 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-68d133bb-6592-4948-9735-a826f081ae02')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-68d133bb-6592-4948-9735-a826f081ae02 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-68d133bb-6592-4948-9735-a826f081ae02');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-0c4110a5-a387-4afb-9f44-0ddbdd54e88b\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-0c4110a5-a387-4afb-9f44-0ddbdd54e88b')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-0c4110a5-a387-4afb-9f44-0ddbdd54e88b button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"rna_seq"}},"metadata":{},"execution_count":28}]},{"cell_type":"markdown","source":["# Perform differential gene expression analysis\n","\n","We are using the [PyDESeq2](https://pydeseq2.readthedocs.io/en/latest/index.html) implementation of DESeq2 to perform differential gene expression analysis to see if there's a significant difference in gene expression between the ground control and spaceflight samples.  The tool requires our data to be in a particular format, so after we read in the data from OSDR, we'll perform some steps to transform the data accordingly."],"metadata":{"id":"s1M2vDnogde0"},"id":"s1M2vDnogde0"},{"cell_type":"code","execution_count":29,"id":"00429871-be11-4ea6-b44f-ab65e40676c1","metadata":{"id":"00429871-be11-4ea6-b44f-ab65e40676c1","colab":{"base_uri":"https://localhost:8080/","height":677},"executionInfo":{"status":"ok","timestamp":1725737653492,"user_tz":240,"elapsed":277,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"3d37fdb7-3a47-4006-fc6e-67dd8dbe3b75"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                            sample  condition\n","0           SLS-2_TMS_FLT_F13_Cut2          1\n","1           SLS-2_TMS_FLT_F14_Cut2          1\n","2   SLS-2_TMS_FLT_F15_Cut1_LibRep1          1\n","3   SLS-2_TMS_FLT_F15_Cut1_LibRep2          1\n","4   SLS-2_TMS_FLT_F15_Cut1_LibRep3          1\n","5   SLS-2_TMS_FLT_F15_Cut1_LibRep4          1\n","6           SLS-2_TMS_FLT_F15_Cut2          1\n","7           SLS-2_TMS_FLT_F16_Cut2          1\n","8           SLS-2_TMS_FLT_F17_Cut2          1\n","9           SLS-2_TMS_FLT_F18_Cut2          1\n","10           SLS-2_TMS_GC_G10_Cut2          0\n","11           SLS-2_TMS_GC_G11_Cut2          0\n","12   SLS-2_TMS_GC_G12_Cut1_LibRep1          0\n","13   SLS-2_TMS_GC_G12_Cut1_LibRep2          0\n","14   SLS-2_TMS_GC_G12_Cut1_LibRep3          0\n","15   SLS-2_TMS_GC_G12_Cut1_LibRep4          0\n","16           SLS-2_TMS_GC_G12_Cut2          0\n","17           SLS-2_TMS_GC_G22_Cut2          0\n","18           SLS-2_TMS_GC_G23_Cut2          0\n","19           SLS-2_TMS_GC_G24_Cut2          0"],"text/html":["\n","  <div id=\"df-7f0a721b-5507-4d5b-bc4e-36b1799006f9\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>sample</th>\n","      <th>condition</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>SLS-2_TMS_FLT_F13_Cut2</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>SLS-2_TMS_FLT_F14_Cut2</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>SLS-2_TMS_FLT_F15_Cut1_LibRep1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>SLS-2_TMS_FLT_F15_Cut1_LibRep2</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>SLS-2_TMS_FLT_F15_Cut1_LibRep3</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>SLS-2_TMS_FLT_F15_Cut1_LibRep4</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>SLS-2_TMS_FLT_F15_Cut2</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>SLS-2_TMS_FLT_F16_Cut2</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>SLS-2_TMS_FLT_F17_Cut2</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>SLS-2_TMS_FLT_F18_Cut2</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>SLS-2_TMS_GC_G10_Cut2</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>SLS-2_TMS_GC_G11_Cut2</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>SLS-2_TMS_GC_G12_Cut1_LibRep1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>SLS-2_TMS_GC_G12_Cut1_LibRep2</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>SLS-2_TMS_GC_G12_Cut1_LibRep3</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>SLS-2_TMS_GC_G12_Cut1_LibRep4</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>SLS-2_TMS_GC_G12_Cut2</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>SLS-2_TMS_GC_G22_Cut2</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>18</th>\n","      <td>SLS-2_TMS_GC_G23_Cut2</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>19</th>\n","      <td>SLS-2_TMS_GC_G24_Cut2</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7f0a721b-5507-4d5b-bc4e-36b1799006f9')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-7f0a721b-5507-4d5b-bc4e-36b1799006f9 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-7f0a721b-5507-4d5b-bc4e-36b1799006f9');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-38dfc07a-bdfc-47ec-89f0-9478a5708b31\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-38dfc07a-bdfc-47ec-89f0-9478a5708b31')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-38dfc07a-bdfc-47ec-89f0-9478a5708b31 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","  <div id=\"id_8b212f25-22be-4294-963b-a3cc9e7c1681\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('conditions')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_8b212f25-22be-4294-963b-a3cc9e7c1681 button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('conditions');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"conditions","summary":"{\n  \"name\": \"conditions\",\n  \"rows\": 20,\n  \"fields\": [\n    {\n      \"column\": \"sample\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 20,\n        \"samples\": [\n          \"SLS-2_TMS_FLT_F13_Cut2\",\n          \"SLS-2_TMS_GC_G22_Cut2\",\n          \"SLS-2_TMS_GC_G12_Cut1_LibRep4\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"condition\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 0,\n        \"max\": 1,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          0,\n          1\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":29}],"source":["# First let's create a conditions table for 'Factor Value: Spaceflight'. We'll assign 0 for ground control and 1 for spaceflight\n","condition_dict=dict()\n","for sample in list(rna_seq['sample']):\n","    val=metadata['423'][metadata['423']['Sample Name']==sample]['Factor Value[Spaceflight]'].values[0]\n","    if val == 'Ground Control':\n","        condition_dict[sample] = 0\n","    elif val == 'Vivarium Control':\n","        condition_dict[sample] = 0\n","    else:\n","        condition_dict[sample] = 1\n","rna_seq[\"condition\"] = rna_seq[\"sample\"].map(condition_dict)\n","conditions=rna_seq[['sample', 'condition']]\n","conditions"]},{"cell_type":"code","execution_count":30,"id":"27904330-57d9-41c1-bc9f-9e35473a0506","metadata":{"id":"27904330-57d9-41c1-bc9f-9e35473a0506","colab":{"base_uri":"https://localhost:8080/","height":273},"executionInfo":{"status":"ok","timestamp":1725737701452,"user_tz":240,"elapsed":2001,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"81d03f60-de1a-4b95-bc10-e8319ef0c93d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   ENSRNOG00000000001  ENSRNOG00000000007  ENSRNOG00000000010  \\\n","0                   6                   1                   7   \n","1                   0                   5                  10   \n","2                  12                   0                   0   \n","3                   0                   0                   8   \n","4                  17                  15                   7   \n","\n","   ENSRNOG00000000012  ENSRNOG00000000017  ENSRNOG00000000021  \\\n","0                  92                   9                   0   \n","1                  44                   1                   5   \n","2                  19                   0                   6   \n","3                  11                   0                   0   \n","4                  32                  11                   0   \n","\n","   ENSRNOG00000000024  ENSRNOG00000000033  ENSRNOG00000000034  \\\n","0                 376                   6                  50   \n","1                 226                  14                   6   \n","2                 123                   6                   0   \n","3                  91                   0                   7   \n","4                 170                   9                   2   \n","\n","   ENSRNOG00000000036  ...  ERCC-00157  ERCC-00158  ERCC-00160  ERCC-00162  \\\n","0                  10  ...         410          21         713        1197   \n","1                  12  ...          65           5         383         964   \n","2                   4  ...          84          10         205         440   \n","3                   2  ...          93          16         103         330   \n","4                   1  ...         137          16         202         624   \n","\n","   ERCC-00163  ERCC-00164  ERCC-00165  ERCC-00168  ERCC-00170  ERCC-00171  \n","0        1177          51        3059          53         446      139278  \n","1         808          46        1731          22         329       90587  \n","2         325           5         895           0         101       39846  \n","3         344          13         652           0         124       39121  \n","4         583          22        1219          15         105       63628  \n","\n","[5 rows x 19627 columns]"],"text/html":["\n","  <div id=\"df-c3940759-8987-4d22-8e62-fa99462c181e\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ENSRNOG00000000001</th>\n","      <th>ENSRNOG00000000007</th>\n","      <th>ENSRNOG00000000010</th>\n","      <th>ENSRNOG00000000012</th>\n","      <th>ENSRNOG00000000017</th>\n","      <th>ENSRNOG00000000021</th>\n","      <th>ENSRNOG00000000024</th>\n","      <th>ENSRNOG00000000033</th>\n","      <th>ENSRNOG00000000034</th>\n","      <th>ENSRNOG00000000036</th>\n","      <th>...</th>\n","      <th>ERCC-00157</th>\n","      <th>ERCC-00158</th>\n","      <th>ERCC-00160</th>\n","      <th>ERCC-00162</th>\n","      <th>ERCC-00163</th>\n","      <th>ERCC-00164</th>\n","      <th>ERCC-00165</th>\n","      <th>ERCC-00168</th>\n","      <th>ERCC-00170</th>\n","      <th>ERCC-00171</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>6</td>\n","      <td>1</td>\n","      <td>7</td>\n","      <td>92</td>\n","      <td>9</td>\n","      <td>0</td>\n","      <td>376</td>\n","      <td>6</td>\n","      <td>50</td>\n","      <td>10</td>\n","      <td>...</td>\n","      <td>410</td>\n","      <td>21</td>\n","      <td>713</td>\n","      <td>1197</td>\n","      <td>1177</td>\n","      <td>51</td>\n","      <td>3059</td>\n","      <td>53</td>\n","      <td>446</td>\n","      <td>139278</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>5</td>\n","      <td>10</td>\n","      <td>44</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>226</td>\n","      <td>14</td>\n","      <td>6</td>\n","      <td>12</td>\n","      <td>...</td>\n","      <td>65</td>\n","      <td>5</td>\n","      <td>383</td>\n","      <td>964</td>\n","      <td>808</td>\n","      <td>46</td>\n","      <td>1731</td>\n","      <td>22</td>\n","      <td>329</td>\n","      <td>90587</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>12</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>19</td>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>123</td>\n","      <td>6</td>\n","      <td>0</td>\n","      <td>4</td>\n","      <td>...</td>\n","      <td>84</td>\n","      <td>10</td>\n","      <td>205</td>\n","      <td>440</td>\n","      <td>325</td>\n","      <td>5</td>\n","      <td>895</td>\n","      <td>0</td>\n","      <td>101</td>\n","      <td>39846</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>8</td>\n","      <td>11</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>91</td>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>2</td>\n","      <td>...</td>\n","      <td>93</td>\n","      <td>16</td>\n","      <td>103</td>\n","      <td>330</td>\n","      <td>344</td>\n","      <td>13</td>\n","      <td>652</td>\n","      <td>0</td>\n","      <td>124</td>\n","      <td>39121</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>17</td>\n","      <td>15</td>\n","      <td>7</td>\n","      <td>32</td>\n","      <td>11</td>\n","      <td>0</td>\n","      <td>170</td>\n","      <td>9</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>...</td>\n","      <td>137</td>\n","      <td>16</td>\n","      <td>202</td>\n","      <td>624</td>\n","      <td>583</td>\n","      <td>22</td>\n","      <td>1219</td>\n","      <td>15</td>\n","      <td>105</td>\n","      <td>63628</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows Ã— 19627 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c3940759-8987-4d22-8e62-fa99462c181e')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-c3940759-8987-4d22-8e62-fa99462c181e button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-c3940759-8987-4d22-8e62-fa99462c181e');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-12b00f0e-1a35-4552-99c6-b9d11c1f4944\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-12b00f0e-1a35-4552-99c6-b9d11c1f4944')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-12b00f0e-1a35-4552-99c6-b9d11c1f4944 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"counts"}},"metadata":{},"execution_count":30}],"source":["# remove sample and condition from rna_seq dataframe\n","counts=rna_seq.drop(columns=['sample', 'condition']).reset_index(drop=True)\n","# check for non-numeric\n","counts.applymap(m.np.isreal)\n","# convert all cells to integers\n","counts=counts.astype(int)\n","counts.head()"]},{"cell_type":"code","execution_count":31,"id":"49bb64e5-b19b-4473-8380-7bb7f170f782","metadata":{"id":"49bb64e5-b19b-4473-8380-7bb7f170f782","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1725737834245,"user_tz":240,"elapsed":120137,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"96447c90-7082-436d-98f9-c810b76668f9"},"outputs":[{"output_type":"stream","name":"stderr","text":["Fitting size factors...\n","... done in 0.05 seconds.\n","\n","Fitting dispersions...\n","... done in 31.37 seconds.\n","\n","Fitting dispersion trend curve...\n","... done in 1.18 seconds.\n","\n","Fitting MAP dispersions...\n","... done in 34.72 seconds.\n","\n","Fitting LFCs...\n","... done in 23.49 seconds.\n","\n","Calculating cook's distance...\n","... done in 0.06 seconds.\n","\n","Replacing 273 outlier genes.\n","\n","Fitting dispersions...\n","... done in 0.35 seconds.\n","\n","Fitting MAP dispersions...\n","... done in 0.32 seconds.\n","\n","Fitting LFCs...\n","... done in 0.42 seconds.\n","\n","Running Wald tests...\n"]},{"output_type":"stream","name":"stdout","text":["Log2 fold change & Wald test p-value: condition 0 vs 1\n","                        baseMean  log2FoldChange     lfcSE      stat  \\\n","ENSRNOG00000000001      4.153143       -0.451991  1.109199 -0.407494   \n","ENSRNOG00000000007      1.181897       -2.810010  1.904614 -1.475370   \n","ENSRNOG00000000010      7.059234        0.354164  0.713212  0.496575   \n","ENSRNOG00000000012     29.397464       -0.144226  0.355632 -0.405548   \n","ENSRNOG00000000017      2.621813       -1.553522  1.139652 -1.363155   \n","...                          ...             ...       ...       ...   \n","ERCC-00164             24.957565        0.462630  0.435011  1.063491   \n","ERCC-00165           2328.141936        1.125700  0.162515  6.926732   \n","ERCC-00168             19.414640        0.405389  0.858003  0.472479   \n","ERCC-00170            128.694377       -1.605951  0.248866 -6.453068   \n","ERCC-00171          72131.826217       -0.068365  0.137491 -0.497229   \n","\n","                          pvalue          padj  \n","ENSRNOG00000000001  6.836455e-01  8.849916e-01  \n","ENSRNOG00000000007  1.401131e-01           NaN  \n","ENSRNOG00000000010  6.194885e-01  8.508411e-01  \n","ENSRNOG00000000012  6.850747e-01  8.852630e-01  \n","ENSRNOG00000000017  1.728338e-01  4.791914e-01  \n","...                          ...           ...  \n","ERCC-00164          2.875593e-01  6.157589e-01  \n","ERCC-00165          4.306724e-12  1.097728e-09  \n","ERCC-00168          6.365846e-01  8.601033e-01  \n","ERCC-00170          1.096082e-10  2.405748e-08  \n","ERCC-00171          6.190275e-01  8.504296e-01  \n","\n","[19627 rows x 6 columns]\n"]},{"output_type":"stream","name":"stderr","text":["... done in 4.89 seconds.\n","\n"]}],"source":["# run the DESEq2 experiment contrasting conditin \"0\" (ground control) to condition \"1\" (spaceflight)\n","dds=m.DeseqDataSet(counts=counts, metadata=conditions, design_factors=\"condition\")\n","dds.deseq2()\n","stats_results = m.DeseqStats(dds, contrast = ('condition', '0', '1'))\n","stats_results.summary()\n","res = stats_results.results_df"]},{"cell_type":"code","source":["# extract results of the DESeq2 experiment where  padj < 0.05, and log2fc > 0\n","#res = res[res.baseMean >= 10000]\n","sigs = res[(res.padj < 0.05) & (abs(res.log2FoldChange) > 0)]\n","gene_list=list(sigs.index)\n","print(len(gene_list))"],"metadata":{"id":"IJUv4VHVKXK0","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1725737834245,"user_tz":240,"elapsed":96,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"9df610e2-ee16-4fff-8e16-dd77c78b86cc"},"id":"IJUv4VHVKXK0","execution_count":32,"outputs":[{"output_type":"stream","name":"stdout","text":["1250\n"]}]},{"cell_type":"code","source":["# use m.read_rnaseq_data() to read in the normalized transcriptomic counts from OSD-423\n","data['423-normalized'] = m.read_rnaseq_data('423_rna_seq_Normalized_Counts')\n","rna_seq_normalized = data['423-normalized']"],"metadata":{"id":"2INL-S_XyuI0","executionInfo":{"status":"ok","timestamp":1725737835524,"user_tz":240,"elapsed":1281,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}}},"id":"2INL-S_XyuI0","execution_count":33,"outputs":[]},{"cell_type":"code","source":["# Keep the first column and filter the rest based on the gene_list\n","rna_seq_deg = rna_seq_normalized[rna_seq_normalized.iloc[:, 0].isin(gene_list)]\n","rna_seq_deg.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"AmkdWw0YreBg","executionInfo":{"status":"ok","timestamp":1725737835524,"user_tz":240,"elapsed":10,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"668b0ddd-517c-44db-a3a9-21e458518467"},"id":"AmkdWw0YreBg","execution_count":34,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1190, 13)"]},"metadata":{},"execution_count":34}]},{"cell_type":"code","source":["rna_seq_deg.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":244},"id":"4IkODOnwuEep","executionInfo":{"status":"ok","timestamp":1725737835524,"user_tz":240,"elapsed":9,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"d01a3b52-79e9-47d5-b813-9da45e11219e"},"id":"4IkODOnwuEep","execution_count":35,"outputs":[{"output_type":"execute_result","data":{"text/plain":["            Unnamed: 0  SLS-2_TMS_FLT_F13_Cut2  SLS-2_TMS_FLT_F14_Cut2  \\\n","10  ENSRNOG00000000043               46.891311               70.222834   \n","46  ENSRNOG00000000145              146.407537              247.546344   \n","47  ENSRNOG00000000150              359.010156              344.948859   \n","54  ENSRNOG00000000164              880.501553             1116.707754   \n","80  ENSRNOG00000000246               69.275855               69.442754   \n","\n","    SLS-2_TMS_FLT_F15_Cut2  SLS-2_TMS_FLT_F16_Cut2  SLS-2_TMS_FLT_F17_Cut2  \\\n","10               48.974123               72.692273               61.259636   \n","46              195.296237              216.093983              138.224106   \n","47              372.736772              279.142273              406.202395   \n","54              868.245813              817.108336              959.921370   \n","80               82.409486              112.740775              138.102033   \n","\n","    SLS-2_TMS_FLT_F18_Cut2  SLS-2_TMS_GC_G10_Cut2  SLS-2_TMS_GC_G11_Cut2  \\\n","10               13.841262              23.189392               6.693054   \n","46              120.188482              77.932954             114.857597   \n","47              152.965367             244.418768             262.996055   \n","54              703.655794             666.728271             619.913004   \n","80               40.479962             141.949066              71.772847   \n","\n","    SLS-2_TMS_GC_G12_Cut2  SLS-2_TMS_GC_G22_Cut2  SLS-2_TMS_GC_G23_Cut2  \\\n","10              32.252522              24.460652              26.816448   \n","46              86.624075              80.069739             132.814700   \n","47             237.623747             149.488380             288.999018   \n","54             748.188464             540.843873             927.884613   \n","80             146.535025             119.737121             162.256787   \n","\n","    SLS-2_TMS_GC_G24_Cut2  \n","10              37.494840  \n","46              67.070883  \n","47             229.592636  \n","54             614.250378  \n","80             146.645875  "],"text/html":["\n","  <div id=\"df-535ede0e-57d0-4dc2-a8bd-5a3287575c23\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>SLS-2_TMS_FLT_F13_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F14_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F15_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F16_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F17_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F18_Cut2</th>\n","      <th>SLS-2_TMS_GC_G10_Cut2</th>\n","      <th>SLS-2_TMS_GC_G11_Cut2</th>\n","      <th>SLS-2_TMS_GC_G12_Cut2</th>\n","      <th>SLS-2_TMS_GC_G22_Cut2</th>\n","      <th>SLS-2_TMS_GC_G23_Cut2</th>\n","      <th>SLS-2_TMS_GC_G24_Cut2</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>10</th>\n","      <td>ENSRNOG00000000043</td>\n","      <td>46.891311</td>\n","      <td>70.222834</td>\n","      <td>48.974123</td>\n","      <td>72.692273</td>\n","      <td>61.259636</td>\n","      <td>13.841262</td>\n","      <td>23.189392</td>\n","      <td>6.693054</td>\n","      <td>32.252522</td>\n","      <td>24.460652</td>\n","      <td>26.816448</td>\n","      <td>37.494840</td>\n","    </tr>\n","    <tr>\n","      <th>46</th>\n","      <td>ENSRNOG00000000145</td>\n","      <td>146.407537</td>\n","      <td>247.546344</td>\n","      <td>195.296237</td>\n","      <td>216.093983</td>\n","      <td>138.224106</td>\n","      <td>120.188482</td>\n","      <td>77.932954</td>\n","      <td>114.857597</td>\n","      <td>86.624075</td>\n","      <td>80.069739</td>\n","      <td>132.814700</td>\n","      <td>67.070883</td>\n","    </tr>\n","    <tr>\n","      <th>47</th>\n","      <td>ENSRNOG00000000150</td>\n","      <td>359.010156</td>\n","      <td>344.948859</td>\n","      <td>372.736772</td>\n","      <td>279.142273</td>\n","      <td>406.202395</td>\n","      <td>152.965367</td>\n","      <td>244.418768</td>\n","      <td>262.996055</td>\n","      <td>237.623747</td>\n","      <td>149.488380</td>\n","      <td>288.999018</td>\n","      <td>229.592636</td>\n","    </tr>\n","    <tr>\n","      <th>54</th>\n","      <td>ENSRNOG00000000164</td>\n","      <td>880.501553</td>\n","      <td>1116.707754</td>\n","      <td>868.245813</td>\n","      <td>817.108336</td>\n","      <td>959.921370</td>\n","      <td>703.655794</td>\n","      <td>666.728271</td>\n","      <td>619.913004</td>\n","      <td>748.188464</td>\n","      <td>540.843873</td>\n","      <td>927.884613</td>\n","      <td>614.250378</td>\n","    </tr>\n","    <tr>\n","      <th>80</th>\n","      <td>ENSRNOG00000000246</td>\n","      <td>69.275855</td>\n","      <td>69.442754</td>\n","      <td>82.409486</td>\n","      <td>112.740775</td>\n","      <td>138.102033</td>\n","      <td>40.479962</td>\n","      <td>141.949066</td>\n","      <td>71.772847</td>\n","      <td>146.535025</td>\n","      <td>119.737121</td>\n","      <td>162.256787</td>\n","      <td>146.645875</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-535ede0e-57d0-4dc2-a8bd-5a3287575c23')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-535ede0e-57d0-4dc2-a8bd-5a3287575c23 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-535ede0e-57d0-4dc2-a8bd-5a3287575c23');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-db65e6e3-d0c3-479c-a07a-2c066941cfaa\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-db65e6e3-d0c3-479c-a07a-2c066941cfaa')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-db65e6e3-d0c3-479c-a07a-2c066941cfaa button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"rna_seq_deg","summary":"{\n  \"name\": \"rna_seq_deg\",\n  \"rows\": 1190,\n  \"fields\": [\n    {\n      \"column\": \"Unnamed: 0\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 1190,\n        \"samples\": [\n          \"ENSRNOG00000012847\",\n          \"ENSRNOG00000008455\",\n          \"ENSRNOG00000008797\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_FLT_F13_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 4071.590640495409,\n        \"min\": 0.0,\n        \"max\": 112596.365384404,\n        \"num_unique_values\": 1165,\n        \"samples\": [\n          1023.3717775385,\n          3916.37751686584,\n          66.4835918642197\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_FLT_F14_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 5711.730330253148,\n        \"min\": 0.0,\n        \"max\": 175405.683257527,\n        \"num_unique_values\": 1174,\n        \"samples\": [\n          63.830380893125,\n          65.0409313254509,\n          16.4199474363913\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_FLT_F15_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 5103.85847066283,\n        \"min\": 0.0,\n        \"max\": 160701.066240314,\n        \"num_unique_values\": 1165,\n        \"samples\": [\n          7867.40486457874,\n          160.378333285825,\n          283.943789058653\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_FLT_F16_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 9399.266119358115,\n        \"min\": 0.0,\n        \"max\": 318140.048840465,\n        \"num_unique_values\": 1116,\n        \"samples\": [\n          376.962405600617,\n          486.878033568508,\n          384.798559943136\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_FLT_F17_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 13329.938498644524,\n        \"min\": 0.0,\n        \"max\": 456070.089476482,\n        \"num_unique_values\": 1112,\n        \"samples\": [\n          3003.32030495051,\n          346.022233854169,\n          7.07785704651454\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_FLT_F18_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 4759.73169155999,\n        \"min\": 0.0,\n        \"max\": 148359.984446974,\n        \"num_unique_values\": 1111,\n        \"samples\": [\n          123.063525897982,\n          210.753261074277,\n          771.562938081333\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_GC_G10_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3996.8537067531997,\n        \"min\": 0.0,\n        \"max\": 93396.20032561,\n        \"num_unique_values\": 1142,\n        \"samples\": [\n          277.853638181938,\n          405.940307249541,\n          6078.50580547683\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_GC_G11_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 7188.748794306303,\n        \"min\": 0.0,\n        \"max\": 233859.068567674,\n        \"num_unique_values\": 1052,\n        \"samples\": [\n          371.476632869353,\n          233.413800503883,\n          468.320554422288\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_GC_G12_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3651.2635604273123,\n        \"min\": 0.0,\n        \"max\": 78981.9093704687,\n        \"num_unique_values\": 1177,\n        \"samples\": [\n          8251.72649292375,\n          44.3080834760932,\n          72.5455833522498\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_GC_G22_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3745.4917830395557,\n        \"min\": 0.0,\n        \"max\": 102212.877007929,\n        \"num_unique_values\": 1147,\n        \"samples\": [\n          8.34534616780428,\n          16772.1248393942,\n          7.32409439657463\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_GC_G23_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3617.0712756150456,\n        \"min\": 0.0,\n        \"max\": 94201.0546793857,\n        \"num_unique_values\": 1173,\n        \"samples\": [\n          277.063095602695,\n          101.482687899464,\n          168.134052555805\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_GC_G24_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3702.710864833271,\n        \"min\": 0.0,\n        \"max\": 82608.5755920255,\n        \"num_unique_values\": 1113,\n        \"samples\": [\n          60.4755031693907,\n          384.447853925712,\n          1.23369953014206\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":35}]},{"cell_type":"code","source":["# convert gene id to gene symbol\n","# remove any genes that do not have a gene symbol\n","mg=m.mygene.MyGeneInfo()\n","ens=list(rna_seq_deg['Unnamed: 0'])\n","ginfo = mg.querymany(ens, scopes='ensembl.gene')\n","drop_list=list()\n","hit_list=list()\n","for g in ginfo:\n","    if not 'symbol' in g:\n","        drop_list.append(g['query'])\n","    else:\n","        if not g['symbol'] in hit_list:\n","            rna_seq_deg.loc[rna_seq_deg['Unnamed: 0']==g['query'], 'Unnamed: 0']=g['symbol']\n","            hit_list.append(g['symbol'])\n","\n","print('RNA-seq data shape before: ', rna_seq_deg.shape)\n","rna_seq_deg = rna_seq_deg[~rna_seq_deg['Unnamed: 0'].isin(drop_list)]\n","print('RNA-seq data shape after: ', rna_seq_deg.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_9rpOKBYrOJ2","executionInfo":{"status":"ok","timestamp":1725737839876,"user_tz":240,"elapsed":4361,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"3751ef31-a858-491a-c1a8-c15df0b01677"},"id":"_9rpOKBYrOJ2","execution_count":36,"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:biothings.client:querying 1-1000...\n","INFO:biothings.client:done.\n","INFO:biothings.client:querying 1001-1190...\n","INFO:biothings.client:done.\n","INFO:biothings.client:Finished.\n","WARNING:biothings.client:4 input query terms found dup hits:\t[('ENSRNOG00000057774', 2), ('ENSRNOG00000064025', 2), ('ENSRNOG00000070513', 2), ('ENSRNOG000000707\n","INFO:biothings.client:Pass \"returnall=True\" to return complete lists of duplicate or missing query terms.\n"]},{"output_type":"stream","name":"stdout","text":["RNA-seq data shape before:  (1190, 13)\n","RNA-seq data shape after:  (1140, 13)\n"]}]},{"cell_type":"code","source":["rna_seq_deg.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":244},"id":"PXGHX0Bovib5","executionInfo":{"status":"ok","timestamp":1725737839877,"user_tz":240,"elapsed":15,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"43b8c872-6479-43b5-850c-378bef10d998"},"id":"PXGHX0Bovib5","execution_count":37,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   Unnamed: 0  SLS-2_TMS_FLT_F13_Cut2  SLS-2_TMS_FLT_F14_Cut2  \\\n","10       Idua               46.891311               70.222834   \n","46     Pik3r3              146.407537              247.546344   \n","47     Dnajc1              359.010156              344.948859   \n","54      Lamp2              880.501553             1116.707754   \n","80       Amz2               69.275855               69.442754   \n","\n","    SLS-2_TMS_FLT_F15_Cut2  SLS-2_TMS_FLT_F16_Cut2  SLS-2_TMS_FLT_F17_Cut2  \\\n","10               48.974123               72.692273               61.259636   \n","46              195.296237              216.093983              138.224106   \n","47              372.736772              279.142273              406.202395   \n","54              868.245813              817.108336              959.921370   \n","80               82.409486              112.740775              138.102033   \n","\n","    SLS-2_TMS_FLT_F18_Cut2  SLS-2_TMS_GC_G10_Cut2  SLS-2_TMS_GC_G11_Cut2  \\\n","10               13.841262              23.189392               6.693054   \n","46              120.188482              77.932954             114.857597   \n","47              152.965367             244.418768             262.996055   \n","54              703.655794             666.728271             619.913004   \n","80               40.479962             141.949066              71.772847   \n","\n","    SLS-2_TMS_GC_G12_Cut2  SLS-2_TMS_GC_G22_Cut2  SLS-2_TMS_GC_G23_Cut2  \\\n","10              32.252522              24.460652              26.816448   \n","46              86.624075              80.069739             132.814700   \n","47             237.623747             149.488380             288.999018   \n","54             748.188464             540.843873             927.884613   \n","80             146.535025             119.737121             162.256787   \n","\n","    SLS-2_TMS_GC_G24_Cut2  \n","10              37.494840  \n","46              67.070883  \n","47             229.592636  \n","54             614.250378  \n","80             146.645875  "],"text/html":["\n","  <div id=\"df-cd93b13a-3d25-4b5e-905a-832c6e344489\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>SLS-2_TMS_FLT_F13_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F14_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F15_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F16_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F17_Cut2</th>\n","      <th>SLS-2_TMS_FLT_F18_Cut2</th>\n","      <th>SLS-2_TMS_GC_G10_Cut2</th>\n","      <th>SLS-2_TMS_GC_G11_Cut2</th>\n","      <th>SLS-2_TMS_GC_G12_Cut2</th>\n","      <th>SLS-2_TMS_GC_G22_Cut2</th>\n","      <th>SLS-2_TMS_GC_G23_Cut2</th>\n","      <th>SLS-2_TMS_GC_G24_Cut2</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>10</th>\n","      <td>Idua</td>\n","      <td>46.891311</td>\n","      <td>70.222834</td>\n","      <td>48.974123</td>\n","      <td>72.692273</td>\n","      <td>61.259636</td>\n","      <td>13.841262</td>\n","      <td>23.189392</td>\n","      <td>6.693054</td>\n","      <td>32.252522</td>\n","      <td>24.460652</td>\n","      <td>26.816448</td>\n","      <td>37.494840</td>\n","    </tr>\n","    <tr>\n","      <th>46</th>\n","      <td>Pik3r3</td>\n","      <td>146.407537</td>\n","      <td>247.546344</td>\n","      <td>195.296237</td>\n","      <td>216.093983</td>\n","      <td>138.224106</td>\n","      <td>120.188482</td>\n","      <td>77.932954</td>\n","      <td>114.857597</td>\n","      <td>86.624075</td>\n","      <td>80.069739</td>\n","      <td>132.814700</td>\n","      <td>67.070883</td>\n","    </tr>\n","    <tr>\n","      <th>47</th>\n","      <td>Dnajc1</td>\n","      <td>359.010156</td>\n","      <td>344.948859</td>\n","      <td>372.736772</td>\n","      <td>279.142273</td>\n","      <td>406.202395</td>\n","      <td>152.965367</td>\n","      <td>244.418768</td>\n","      <td>262.996055</td>\n","      <td>237.623747</td>\n","      <td>149.488380</td>\n","      <td>288.999018</td>\n","      <td>229.592636</td>\n","    </tr>\n","    <tr>\n","      <th>54</th>\n","      <td>Lamp2</td>\n","      <td>880.501553</td>\n","      <td>1116.707754</td>\n","      <td>868.245813</td>\n","      <td>817.108336</td>\n","      <td>959.921370</td>\n","      <td>703.655794</td>\n","      <td>666.728271</td>\n","      <td>619.913004</td>\n","      <td>748.188464</td>\n","      <td>540.843873</td>\n","      <td>927.884613</td>\n","      <td>614.250378</td>\n","    </tr>\n","    <tr>\n","      <th>80</th>\n","      <td>Amz2</td>\n","      <td>69.275855</td>\n","      <td>69.442754</td>\n","      <td>82.409486</td>\n","      <td>112.740775</td>\n","      <td>138.102033</td>\n","      <td>40.479962</td>\n","      <td>141.949066</td>\n","      <td>71.772847</td>\n","      <td>146.535025</td>\n","      <td>119.737121</td>\n","      <td>162.256787</td>\n","      <td>146.645875</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-cd93b13a-3d25-4b5e-905a-832c6e344489')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-cd93b13a-3d25-4b5e-905a-832c6e344489 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-cd93b13a-3d25-4b5e-905a-832c6e344489');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-52d335d6-06c7-46a9-b215-79d11f98459c\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-52d335d6-06c7-46a9-b215-79d11f98459c')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-52d335d6-06c7-46a9-b215-79d11f98459c button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"rna_seq_deg","summary":"{\n  \"name\": \"rna_seq_deg\",\n  \"rows\": 1140,\n  \"fields\": [\n    {\n      \"column\": \"Unnamed: 0\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 1140,\n        \"samples\": [\n          \"Mzf1\",\n          \"Zfp949\",\n          \"Cdkn3\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_FLT_F13_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 4157.305372365922,\n        \"min\": 0.0,\n        \"max\": 112596.365384404,\n        \"num_unique_values\": 1122,\n        \"samples\": [\n          2328.98239918173,\n          24.6937382664123,\n          1.89953269111959\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_FLT_F14_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 5833.4563607643,\n        \"min\": 0.0,\n        \"max\": 175405.683257527,\n        \"num_unique_values\": 1126,\n        \"samples\": [\n          2040.93331832744,\n          201.232059856778,\n          165.734525655266\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_FLT_F15_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 5212.332513488984,\n        \"min\": 0.0,\n        \"max\": 160701.066240314,\n        \"num_unique_values\": 1121,\n        \"samples\": [\n          110.93361032965,\n          152.959056038404,\n          13.9459288665794\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_FLT_F16_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 9601.687764139746,\n        \"min\": 0.0,\n        \"max\": 318140.048840465,\n        \"num_unique_values\": 1078,\n        \"samples\": [\n          386.240364447491,\n          428.42610395136,\n          75.1997120672999\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_FLT_F17_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 13617.770805819619,\n        \"min\": 0.0,\n        \"max\": 456070.089476482,\n        \"num_unique_values\": 1072,\n        \"samples\": [\n          86.5063487205886,\n          30.0898720127587,\n          206.868457225511\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_FLT_F18_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 4860.479846844898,\n        \"min\": 0.0,\n        \"max\": 148359.984446974,\n        \"num_unique_values\": 1073,\n        \"samples\": [\n          460.813130040512,\n          33.9922156703901,\n          577.902088378858\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_GC_G10_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 4079.6832248170904,\n        \"min\": 0.0,\n        \"max\": 93396.20032561,\n        \"num_unique_values\": 1100,\n        \"samples\": [\n          649.935320121996,\n          1229.98156180215,\n          181.241943549386\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_GC_G11_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 7342.492974068269,\n        \"min\": 0.0,\n        \"max\": 233859.068567674,\n        \"num_unique_values\": 1019,\n        \"samples\": [\n          115.060408015075,\n          63.9836580213074,\n          798.794417225968\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_GC_G12_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3727.030782762967,\n        \"min\": 0.0,\n        \"max\": 78981.9093704687,\n        \"num_unique_values\": 1130,\n        \"samples\": [\n          110.088530986398,\n          34.5112270452616,\n          197.206413713805\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_GC_G22_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3823.2877760174542,\n        \"min\": 0.0,\n        \"max\": 102212.877007929,\n        \"num_unique_values\": 1103,\n        \"samples\": [\n          1007.75644525203,\n          45.6888675347497,\n          742.111036645578\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_GC_G23_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3692.440300632585,\n        \"min\": 0.0,\n        \"max\": 94201.0546793857,\n        \"num_unique_values\": 1128,\n        \"samples\": [\n          74.1220158899285,\n          769.032705546858,\n          172.779029340895\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SLS-2_TMS_GC_G24_Cut2\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3779.7195572773508,\n        \"min\": 0.0,\n        \"max\": 82608.5755920255,\n        \"num_unique_values\": 1073,\n        \"samples\": [\n          231.666772088472,\n          7.91040713608711,\n          151.032345127244\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":37}]},{"cell_type":"code","source":["# Export the filtered DataFrame to CSV\n","rna_seq_deg.to_csv('mnt/My Drive/Colab Notebooks/Capstone/GLDS-423_rna_seq_DEG_Normalized_Filtered_Counts.csv', index=False)"],"metadata":{"id":"mjEdLUsvrugB","executionInfo":{"status":"ok","timestamp":1725737883034,"user_tz":240,"elapsed":179,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}}},"id":"mjEdLUsvrugB","execution_count":38,"outputs":[]}],"metadata":{"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.0"},"colab":{"provenance":[{"file_id":"1GlIb73_SV4nulnOjA1oDUM6On66TNon0","timestamp":1725732163262},{"file_id":"1mHQqgaNjSAouku70TDmj-KMLLT4ZkDS2","timestamp":1721786269187},{"file_id":"16sf3GnBZLoH7AoXKLaVcnUpTfEi5dfPb","timestamp":1712450653875}],"collapsed_sections":["TfD_cDSmgvVg"]}},"nbformat":4,"nbformat_minor":5}