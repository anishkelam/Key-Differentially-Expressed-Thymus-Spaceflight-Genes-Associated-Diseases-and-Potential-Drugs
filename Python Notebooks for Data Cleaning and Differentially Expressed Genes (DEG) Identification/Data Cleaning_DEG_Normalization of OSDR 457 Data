{"cells":[{"cell_type":"markdown","source":["# **Mission of the bioinformatic tools notebook**\n","\n","You have just trained, tested, and validated classification and regression models to predict the response of retina phenotypes to the gene expression based on RNA-seq .  Some of your models are promising to predict the phenotype based on their performance.  Now we wish to validate your findings by comparing your results with those obtained from traditional statistical bioinformatic tools.  We also wish to intepret your findings by determining the biological significance of those genes that your models identified.\n","\n","Your approach is to use various traditional statistical tools that bioinformaticians use when they analyze the same sort of data (gene expression accompanied by a phenotype).  These tools include [DESeq2](https://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html), [gene set enrichment analysis](https://en.wikipedia.org/wiki/Gene_set_enrichment_analysis), and [pathway enrichment analysis](https://en.wikipedia.org/wiki/Pathway_analysis)."],"metadata":{"id":"2_1woxDHvZg1"},"id":"2_1woxDHvZg1"},{"cell_type":"markdown","source":["# Read in the notebook methods"],"metadata":{"id":"vNzwLSWNexzW"},"id":"vNzwLSWNexzW"},{"cell_type":"code","source":["# install and import the python module for importing a notebook\n","!pip install import_ipynb\n","import import_ipynb"],"metadata":{"id":"QDdJYIsHTWjs","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1725752363615,"user_tz":240,"elapsed":5738,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"d9b00744-bc3a-4360-f93e-3954bcaceadb"},"id":"QDdJYIsHTWjs","execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting import_ipynb\n","  Downloading import_ipynb-0.1.4-py3-none-any.whl.metadata (2.3 kB)\n","Requirement already satisfied: IPython in /usr/local/lib/python3.10/dist-packages (from import_ipynb) (7.34.0)\n","Requirement already satisfied: nbformat in /usr/local/lib/python3.10/dist-packages (from import_ipynb) (5.10.4)\n","Requirement already satisfied: setuptools>=18.5 in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (71.0.4)\n","Collecting jedi>=0.16 (from IPython->import_ipynb)\n","  Using cached jedi-0.19.1-py2.py3-none-any.whl.metadata (22 kB)\n","Requirement already satisfied: decorator in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (4.4.2)\n","Requirement already satisfied: pickleshare in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (0.7.5)\n","Requirement already satisfied: traitlets>=4.2 in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (5.7.1)\n","Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (3.0.47)\n","Requirement already satisfied: pygments in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (2.16.1)\n","Requirement already satisfied: backcall in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (0.2.0)\n","Requirement already satisfied: matplotlib-inline in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (0.1.7)\n","Requirement already satisfied: pexpect>4.3 in /usr/local/lib/python3.10/dist-packages (from IPython->import_ipynb) (4.9.0)\n","Requirement already satisfied: fastjsonschema>=2.15 in /usr/local/lib/python3.10/dist-packages (from nbformat->import_ipynb) (2.20.0)\n","Requirement already satisfied: jsonschema>=2.6 in /usr/local/lib/python3.10/dist-packages (from nbformat->import_ipynb) (4.23.0)\n","Requirement already satisfied: jupyter-core!=5.0.*,>=4.12 in /usr/local/lib/python3.10/dist-packages (from nbformat->import_ipynb) (5.7.2)\n","Requirement already satisfied: parso<0.9.0,>=0.8.3 in /usr/local/lib/python3.10/dist-packages (from jedi>=0.16->IPython->import_ipynb) (0.8.4)\n","Requirement already satisfied: attrs>=22.2.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat->import_ipynb) (24.2.0)\n","Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat->import_ipynb) (2023.12.1)\n","Requirement already satisfied: referencing>=0.28.4 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat->import_ipynb) (0.35.1)\n","Requirement already satisfied: rpds-py>=0.7.1 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=2.6->nbformat->import_ipynb) (0.20.0)\n","Requirement already satisfied: platformdirs>=2.5 in /usr/local/lib/python3.10/dist-packages (from jupyter-core!=5.0.*,>=4.12->nbformat->import_ipynb) (4.2.2)\n","Requirement already satisfied: ptyprocess>=0.5 in /usr/local/lib/python3.10/dist-packages (from pexpect>4.3->IPython->import_ipynb) (0.7.0)\n","Requirement already satisfied: wcwidth in /usr/local/lib/python3.10/dist-packages (from prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0->IPython->import_ipynb) (0.2.13)\n","Downloading import_ipynb-0.1.4-py3-none-any.whl (4.1 kB)\n","Using cached jedi-0.19.1-py2.py3-none-any.whl (1.6 MB)\n","Installing collected packages: jedi, import_ipynb\n","Successfully installed import_ipynb-0.1.4 jedi-0.19.1\n"]}]},{"cell_type":"code","source":["# mount your google drive to this notebook\n","from google.colab import drive\n","drive.flush_and_unmount()\n","drive.mount(\"mnt\", force_remount=True)"],"metadata":{"id":"2BFgmmNcg91q","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1725752384335,"user_tz":240,"elapsed":20724,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"1a8cef96-119c-485d-c36a-d77b75399416"},"id":"2BFgmmNcg91q","execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Drive not mounted, so nothing to flush and unmount.\n","Mounted at mnt\n"]}]},{"cell_type":"code","source":["# import the \"Copy of methods.ipynb\" from your google drive into this notebook\n","m = __import__(\"mnt/MyDrive/Colab Notebooks/Copy of methods\")"],"metadata":{"id":"zHKKJqxSTb5_","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1725752457774,"user_tz":240,"elapsed":73446,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"2eb5e637-cc9a-4c3a-b8b0-472d287723f6"},"id":"zHKKJqxSTb5_","execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["importing Jupyter notebook from mnt/MyDrive/Colab Notebooks/Copy of methods.ipynb\n","Requirement already satisfied: scikit-learn in /usr/local/lib/python3.10/dist-packages (1.3.2)\n","Requirement already satisfied: numpy<2.0,>=1.17.3 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (1.26.4)\n","Requirement already satisfied: scipy>=1.5.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (1.13.1)\n","Requirement already satisfied: joblib>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (1.4.2)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (3.5.0)\n","Collecting scanpy\n","  Downloading scanpy-1.10.2-py3-none-any.whl.metadata (9.3 kB)\n","Collecting anndata>=0.8 (from scanpy)\n","  Downloading anndata-0.10.9-py3-none-any.whl.metadata (6.9 kB)\n","Requirement already satisfied: h5py>=3.1 in /usr/local/lib/python3.10/dist-packages (from scanpy) (3.11.0)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.10/dist-packages (from scanpy) (1.4.2)\n","Collecting legacy-api-wrap>=1.4 (from scanpy)\n","  Downloading legacy_api_wrap-1.4-py3-none-any.whl.metadata (1.8 kB)\n","Requirement already satisfied: matplotlib>=3.6 in /usr/local/lib/python3.10/dist-packages (from scanpy) (3.7.1)\n","Requirement already satisfied: natsort in /usr/local/lib/python3.10/dist-packages (from scanpy) (8.4.0)\n","Requirement already satisfied: networkx>=2.7 in /usr/local/lib/python3.10/dist-packages (from scanpy) (3.3)\n","Requirement already satisfied: numba>=0.56 in /usr/local/lib/python3.10/dist-packages (from scanpy) (0.60.0)\n","Requirement already satisfied: numpy<2,>=1.23 in /usr/local/lib/python3.10/dist-packages (from scanpy) (1.26.4)\n","Requirement already satisfied: packaging>=21.3 in /usr/local/lib/python3.10/dist-packages (from scanpy) (24.1)\n","Requirement already satisfied: pandas>=1.5 in /usr/local/lib/python3.10/dist-packages (from scanpy) (2.1.4)\n","Requirement already satisfied: patsy in /usr/local/lib/python3.10/dist-packages (from scanpy) (0.5.6)\n","Collecting pynndescent>=0.5 (from scanpy)\n","  Downloading pynndescent-0.5.13-py3-none-any.whl.metadata (6.8 kB)\n","Requirement already satisfied: scikit-learn>=0.24 in /usr/local/lib/python3.10/dist-packages (from scanpy) (1.3.2)\n","Requirement already satisfied: scipy>=1.8 in /usr/local/lib/python3.10/dist-packages (from scanpy) (1.13.1)\n","Requirement already satisfied: seaborn>=0.13 in /usr/local/lib/python3.10/dist-packages (from scanpy) (0.13.1)\n","Collecting session-info (from scanpy)\n","  Downloading session_info-1.0.0.tar.gz (24 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: statsmodels>=0.13 in /usr/local/lib/python3.10/dist-packages (from scanpy) (0.14.2)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from scanpy) (4.66.5)\n","Collecting umap-learn!=0.5.0,>=0.5 (from scanpy)\n","  Downloading umap_learn-0.5.6-py3-none-any.whl.metadata (21 kB)\n","Collecting array-api-compat!=1.5,>1.4 (from anndata>=0.8->scanpy)\n","  Downloading array_api_compat-1.8-py3-none-any.whl.metadata (1.5 kB)\n","Requirement already satisfied: exceptiongroup in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8->scanpy) (1.2.2)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6->scanpy) (1.3.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6->scanpy) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6->scanpy) (4.53.1)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6->scanpy) (1.4.5)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6->scanpy) (9.4.0)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6->scanpy) (3.1.4)\n","Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6->scanpy) (2.8.2)\n","Requirement already satisfied: llvmlite<0.44,>=0.43.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba>=0.56->scanpy) (0.43.0)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.5->scanpy) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.5->scanpy) (2024.1)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=0.24->scanpy) (3.5.0)\n","Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from patsy->scanpy) (1.16.0)\n","Collecting stdlib_list (from session-info->scanpy)\n","  Downloading stdlib_list-0.10.0-py3-none-any.whl.metadata (3.3 kB)\n","Downloading scanpy-1.10.2-py3-none-any.whl (2.1 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.1/2.1 MB\u001b[0m \u001b[31m34.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading anndata-0.10.9-py3-none-any.whl (128 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m129.0/129.0 kB\u001b[0m \u001b[31m234.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading legacy_api_wrap-1.4-py3-none-any.whl (15 kB)\n","Downloading pynndescent-0.5.13-py3-none-any.whl (56 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m56.9/56.9 kB\u001b[0m \u001b[31m195.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading umap_learn-0.5.6-py3-none-any.whl (85 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m85.7/85.7 kB\u001b[0m \u001b[31m216.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading array_api_compat-1.8-py3-none-any.whl (38 kB)\n","Downloading stdlib_list-0.10.0-py3-none-any.whl (79 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m79.8/79.8 kB\u001b[0m \u001b[31m196.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hBuilding wheels for collected packages: session-info\n","  Building wheel for session-info (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for session-info: filename=session_info-1.0.0-py3-none-any.whl size=8023 sha256=3bc1a7bae20cf9ec17266fe98d93542f0c0d1d0eb3393a2b516b39eabc239ea0\n","  Stored in directory: /tmp/pip-ephem-wheel-cache-vbn93vzw/wheels/6a/aa/b9/eb5d4031476ec10802795b97ccf937b9bd998d68a9b268765a\n","Successfully built session-info\n","Installing collected packages: array-api-compat, stdlib_list, legacy-api-wrap, session-info, pynndescent, anndata, umap-learn, scanpy\n","Successfully installed anndata-0.10.9 array-api-compat-1.8 legacy-api-wrap-1.4 pynndescent-0.5.13 scanpy-1.10.2 session-info-1.0.0 stdlib_list-0.10.0 umap-learn-0.5.6\n","Collecting gseapy\n","  Downloading gseapy-1.1.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (11 kB)\n","Requirement already satisfied: numpy>=1.13.0 in /usr/local/lib/python3.10/dist-packages (from gseapy) (1.26.4)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from gseapy) (1.13.1)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from gseapy) (2.1.4)\n","Requirement already satisfied: matplotlib>=2.2 in /usr/local/lib/python3.10/dist-packages (from gseapy) (3.7.1)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from gseapy) (2.32.3)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (1.3.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (4.53.1)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (1.4.5)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (24.1)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (9.4.0)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (3.1.4)\n","Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.2->gseapy) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->gseapy) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas->gseapy) (2024.1)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->gseapy) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->gseapy) (3.8)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->gseapy) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->gseapy) (2024.8.30)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.7->matplotlib>=2.2->gseapy) (1.16.0)\n","Downloading gseapy-1.1.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (552 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m552.9/552.9 kB\u001b[0m \u001b[31m8.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: gseapy\n","Successfully installed gseapy-1.1.3\n","Collecting pydeseq2\n","  Downloading pydeseq2-0.4.11-py3-none-any.whl.metadata (7.0 kB)\n","Requirement already satisfied: anndata>=0.8.0 in /usr/local/lib/python3.10/dist-packages (from pydeseq2) (0.10.9)\n","Requirement already satisfied: numpy>=1.23.0 in /usr/local/lib/python3.10/dist-packages (from pydeseq2) (1.26.4)\n","Requirement already satisfied: pandas>=1.4.0 in /usr/local/lib/python3.10/dist-packages (from pydeseq2) (2.1.4)\n","Requirement already satisfied: scikit-learn>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from pydeseq2) (1.3.2)\n","Requirement already satisfied: scipy>=1.11.0 in /usr/local/lib/python3.10/dist-packages (from pydeseq2) (1.13.1)\n","Requirement already satisfied: matplotlib>=3.6.2 in /usr/local/lib/python3.10/dist-packages (from pydeseq2) (3.7.1)\n","Requirement already satisfied: array-api-compat!=1.5,>1.4 in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pydeseq2) (1.8)\n","Requirement already satisfied: exceptiongroup in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pydeseq2) (1.2.2)\n","Requirement already satisfied: h5py>=3.1 in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pydeseq2) (3.11.0)\n","Requirement already satisfied: natsort in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pydeseq2) (8.4.0)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pydeseq2) (24.1)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pydeseq2) (1.3.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pydeseq2) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pydeseq2) (4.53.1)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pydeseq2) (1.4.5)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pydeseq2) (9.4.0)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pydeseq2) (3.1.4)\n","Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pydeseq2) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.0->pydeseq2) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.0->pydeseq2) (2024.1)\n","Requirement already satisfied: joblib>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=1.1.0->pydeseq2) (1.4.2)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=1.1.0->pydeseq2) (3.5.0)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.7->matplotlib>=3.6.2->pydeseq2) (1.16.0)\n","Downloading pydeseq2-0.4.11-py3-none-any.whl (45 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m46.0/46.0 kB\u001b[0m \u001b[31m3.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: pydeseq2\n","Successfully installed pydeseq2-0.4.11\n","Collecting pybiomart==0.1\n","  Downloading pybiomart-0.1.tar.gz (24 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: future in /usr/local/lib/python3.10/dist-packages (from pybiomart==0.1) (1.0.0)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from pybiomart==0.1) (2.1.4)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from pybiomart==0.1) (2.32.3)\n","Collecting requests_cache (from pybiomart==0.1)\n","  Downloading requests_cache-1.2.1-py3-none-any.whl.metadata (9.9 kB)\n","Requirement already satisfied: numpy<2,>=1.22.4 in /usr/local/lib/python3.10/dist-packages (from pandas->pybiomart==0.1) (1.26.4)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas->pybiomart==0.1) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->pybiomart==0.1) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas->pybiomart==0.1) (2024.1)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->pybiomart==0.1) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->pybiomart==0.1) (3.8)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->pybiomart==0.1) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->pybiomart==0.1) (2024.8.30)\n","Requirement already satisfied: attrs>=21.2 in /usr/local/lib/python3.10/dist-packages (from requests_cache->pybiomart==0.1) (24.2.0)\n","Collecting cattrs>=22.2 (from requests_cache->pybiomart==0.1)\n","  Downloading cattrs-24.1.0-py3-none-any.whl.metadata (8.4 kB)\n","Requirement already satisfied: platformdirs>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests_cache->pybiomart==0.1) (4.2.2)\n","Collecting url-normalize>=1.4 (from requests_cache->pybiomart==0.1)\n","  Downloading url_normalize-1.4.3-py2.py3-none-any.whl.metadata (3.1 kB)\n","Requirement already satisfied: exceptiongroup>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from cattrs>=22.2->requests_cache->pybiomart==0.1) (1.2.2)\n","Requirement already satisfied: typing-extensions!=4.6.3,>=4.1.0 in /usr/local/lib/python3.10/dist-packages (from cattrs>=22.2->requests_cache->pybiomart==0.1) (4.12.2)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.2->pandas->pybiomart==0.1) (1.16.0)\n","Downloading requests_cache-1.2.1-py3-none-any.whl (61 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m61.4/61.4 kB\u001b[0m \u001b[31m7.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading cattrs-24.1.0-py3-none-any.whl (66 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m66.2/66.2 kB\u001b[0m \u001b[31m118.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading url_normalize-1.4.3-py2.py3-none-any.whl (6.8 kB)\n","Building wheels for collected packages: pybiomart\n","  Building wheel for pybiomart (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for pybiomart: filename=pybiomart-0.1-py3-none-any.whl size=14599 sha256=cbc5f4b48c3b5d44572f828565d3e8354e642642d9b7821e694b941713c66dfb\n","  Stored in directory: /tmp/pip-ephem-wheel-cache-sae0rd6h/wheels/b3/07/8b/21153224936c782146a686de88b58e1d177b8873104b601ff7\n","Successfully built pybiomart\n","Installing collected packages: url-normalize, cattrs, requests_cache, pybiomart\n","Successfully installed cattrs-24.1.0 pybiomart-0.1 requests_cache-1.2.1 url-normalize-1.4.3\n","Collecting mygene\n","  Downloading mygene-3.2.2-py2.py3-none-any.whl.metadata (10 kB)\n","Collecting biothings-client>=0.2.6 (from mygene)\n","  Downloading biothings_client-0.3.1-py2.py3-none-any.whl.metadata (9.8 kB)\n","Requirement already satisfied: requests>=2.3.0 in /usr/local/lib/python3.10/dist-packages (from biothings-client>=0.2.6->mygene) (2.32.3)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (3.8)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (2024.8.30)\n","Downloading mygene-3.2.2-py2.py3-none-any.whl (5.4 kB)\n","Downloading biothings_client-0.3.1-py2.py3-none-any.whl (29 kB)\n","Installing collected packages: biothings-client, mygene\n","Successfully installed biothings-client-0.3.1 mygene-3.2.2\n","Collecting sklearn_som\n","  Downloading sklearn_som-1.1.0-py3-none-any.whl.metadata (3.7 kB)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from sklearn_som) (1.26.4)\n","Downloading sklearn_som-1.1.0-py3-none-any.whl (6.7 kB)\n","Installing collected packages: sklearn_som\n","Successfully installed sklearn_som-1.1.0\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (2.1.4)\n","Requirement already satisfied: numpy<2,>=1.22.4 in /usr/local/lib/python3.10/dist-packages (from pandas) (1.26.4)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas) (2024.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.2->pandas) (1.16.0)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (1.26.4)\n","Requirement already satisfied: matplotlib in /usr/local/lib/python3.10/dist-packages (3.7.1)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (1.3.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (4.53.1)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (1.4.5)\n","Requirement already satisfied: numpy>=1.20 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (1.26.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (24.1)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (9.4.0)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (3.1.4)\n","Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (2.8.2)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.7->matplotlib) (1.16.0)\n","Requirement already satisfied: sklearn-som in /usr/local/lib/python3.10/dist-packages (1.1.0)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from sklearn-som) (1.26.4)\n","Requirement already satisfied: pyDeseq2 in /usr/local/lib/python3.10/dist-packages (0.4.11)\n","Requirement already satisfied: anndata>=0.8.0 in /usr/local/lib/python3.10/dist-packages (from pyDeseq2) (0.10.9)\n","Requirement already satisfied: numpy>=1.23.0 in /usr/local/lib/python3.10/dist-packages (from pyDeseq2) (1.26.4)\n","Requirement already satisfied: pandas>=1.4.0 in /usr/local/lib/python3.10/dist-packages (from pyDeseq2) (2.1.4)\n","Requirement already satisfied: scikit-learn>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from pyDeseq2) (1.3.2)\n","Requirement already satisfied: scipy>=1.11.0 in /usr/local/lib/python3.10/dist-packages (from pyDeseq2) (1.13.1)\n","Requirement already satisfied: matplotlib>=3.6.2 in /usr/local/lib/python3.10/dist-packages (from pyDeseq2) (3.7.1)\n","Requirement already satisfied: array-api-compat!=1.5,>1.4 in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pyDeseq2) (1.8)\n","Requirement already satisfied: exceptiongroup in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pyDeseq2) (1.2.2)\n","Requirement already satisfied: h5py>=3.1 in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pyDeseq2) (3.11.0)\n","Requirement already satisfied: natsort in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pyDeseq2) (8.4.0)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from anndata>=0.8.0->pyDeseq2) (24.1)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pyDeseq2) (1.3.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pyDeseq2) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pyDeseq2) (4.53.1)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pyDeseq2) (1.4.5)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pyDeseq2) (9.4.0)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pyDeseq2) (3.1.4)\n","Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.6.2->pyDeseq2) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.0->pyDeseq2) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.4.0->pyDeseq2) (2024.1)\n","Requirement already satisfied: joblib>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=1.1.0->pyDeseq2) (1.4.2)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=1.1.0->pyDeseq2) (3.5.0)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.7->matplotlib>=3.6.2->pyDeseq2) (1.16.0)\n","Collecting Ensembl_converter\n","  Downloading ensembl_converter-0.0.1-py3-none-any.whl.metadata (2.5 kB)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from Ensembl_converter) (1.26.4)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from Ensembl_converter) (2.1.4)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from Ensembl_converter) (4.66.5)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from Ensembl_converter) (2.32.3)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas->Ensembl_converter) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->Ensembl_converter) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas->Ensembl_converter) (2024.1)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->Ensembl_converter) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->Ensembl_converter) (3.8)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->Ensembl_converter) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->Ensembl_converter) (2024.8.30)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.2->pandas->Ensembl_converter) (1.16.0)\n","Downloading ensembl_converter-0.0.1-py3-none-any.whl (4.3 kB)\n","Installing collected packages: Ensembl_converter\n","Successfully installed Ensembl_converter-0.0.1\n","Requirement already satisfied: mygene in /usr/local/lib/python3.10/dist-packages (3.2.2)\n","Requirement already satisfied: biothings-client>=0.2.6 in /usr/local/lib/python3.10/dist-packages (from mygene) (0.3.1)\n","Requirement already satisfied: requests>=2.3.0 in /usr/local/lib/python3.10/dist-packages (from biothings-client>=0.2.6->mygene) (2.32.3)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (3.8)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.3.0->biothings-client>=0.2.6->mygene) (2024.8.30)\n","Collecting shap\n","  Downloading shap-0.46.0-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (24 kB)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from shap) (1.26.4)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from shap) (1.13.1)\n","Requirement already satisfied: scikit-learn in /usr/local/lib/python3.10/dist-packages (from shap) (1.3.2)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from shap) (2.1.4)\n","Requirement already satisfied: tqdm>=4.27.0 in /usr/local/lib/python3.10/dist-packages (from shap) (4.66.5)\n","Requirement already satisfied: packaging>20.9 in /usr/local/lib/python3.10/dist-packages (from shap) (24.1)\n","Collecting slicer==0.0.8 (from shap)\n","  Downloading slicer-0.0.8-py3-none-any.whl.metadata (4.0 kB)\n","Requirement already satisfied: numba in /usr/local/lib/python3.10/dist-packages (from shap) (0.60.0)\n","Requirement already satisfied: cloudpickle in /usr/local/lib/python3.10/dist-packages (from shap) (2.2.1)\n","Requirement already satisfied: llvmlite<0.44,>=0.43.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba->shap) (0.43.0)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas->shap) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->shap) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas->shap) (2024.1)\n","Requirement already satisfied: joblib>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn->shap) (1.4.2)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn->shap) (3.5.0)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.2->pandas->shap) (1.16.0)\n","Downloading shap-0.46.0-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (540 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m540.1/540.1 kB\u001b[0m \u001b[31m10.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading slicer-0.0.8-py3-none-any.whl (15 kB)\n","Installing collected packages: slicer, shap\n","Successfully installed shap-0.46.0 slicer-0.0.8\n"]}]},{"cell_type":"markdown","source":["# Read in and prepare the data"],"metadata":{"id":"7NHIuKL3fWZv"},"id":"7NHIuKL3fWZv"},{"cell_type":"markdown","source":["## Read in the data from OSD"],"metadata":{"id":"VjT5Zktaw6sm"},"id":"VjT5Zktaw6sm"},{"cell_type":"code","source":["# define dictionaries for data and metadata\n","data=dict()\n","metadata=dict()"],"metadata":{"id":"igHSU7HQiItA","executionInfo":{"status":"ok","timestamp":1725752457775,"user_tz":240,"elapsed":5,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}}},"id":"igHSU7HQiItA","execution_count":4,"outputs":[]},{"cell_type":"code","source":["# use m.read_rnaseq_data() to read in the normalized transcriptomic counts from OSD-457\n","data['457-unormalized'] = m.read_rnaseq_data('457_rna_seq_STAR_Unnormalized_Counts')\n","print('RNA-seq data shape: ', data['457-unormalized'].shape)\n","data['457-unormalized'].head()"],"metadata":{"id":"b7vRTgp3kTtX","colab":{"base_uri":"https://localhost:8080/","height":273},"executionInfo":{"status":"ok","timestamp":1725752462136,"user_tz":240,"elapsed":4365,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"1d8e1824-6348-4bad-bd72-afe28e3e8f74"},"id":"b7vRTgp3kTtX","execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["RNA-seq data shape:  (56748, 193)\n"]},{"output_type":"execute_result","data":{"text/plain":["           Unnamed: 0  GSM4613909  GSM4613910  GSM4613911  GSM4613912  \\\n","0  ENSMUSG00000000001         719         957         855         650   \n","1  ENSMUSG00000000003           0           0           0           0   \n","2  ENSMUSG00000000028          95          84         175         157   \n","3  ENSMUSG00000000031         763         244        2743        1030   \n","4  ENSMUSG00000000037          17          12          41          33   \n","\n","   GSM4613913  GSM4613914  GSM4613915  GSM4613916  GSM4613917  ...  \\\n","0        1016         954         619         814         988  ...   \n","1           0           0           0           0           0  ...   \n","2         245         273         111         191         280  ...   \n","3        1926        1290        1321        2383        1108  ...   \n","4          46          20          18          26          25  ...   \n","\n","   GSM4614091  GSM4614092  GSM4614093  GSM4614094  GSM4614095  GSM4614096  \\\n","0         308         314         344         347         319         318   \n","1           0           0           0           0           0           0   \n","2          16          19          23          18          11          24   \n","3           0           0           0           0           0           1   \n","4          20          19          10          12          12          16   \n","\n","   GSM4614097  GSM4614098  GSM4614099  GSM4614100  \n","0         307         344         367         327  \n","1           0           0           0           0  \n","2          22          25          21          11  \n","3           1           1           1           3  \n","4           8           7          14          12  \n","\n","[5 rows x 193 columns]"],"text/html":["\n","  <div id=\"df-be2f78da-fb74-45d4-9d99-9f1b6116aed1\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>GSM4613909</th>\n","      <th>GSM4613910</th>\n","      <th>GSM4613911</th>\n","      <th>GSM4613912</th>\n","      <th>GSM4613913</th>\n","      <th>GSM4613914</th>\n","      <th>GSM4613915</th>\n","      <th>GSM4613916</th>\n","      <th>GSM4613917</th>\n","      <th>...</th>\n","      <th>GSM4614091</th>\n","      <th>GSM4614092</th>\n","      <th>GSM4614093</th>\n","      <th>GSM4614094</th>\n","      <th>GSM4614095</th>\n","      <th>GSM4614096</th>\n","      <th>GSM4614097</th>\n","      <th>GSM4614098</th>\n","      <th>GSM4614099</th>\n","      <th>GSM4614100</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ENSMUSG00000000001</td>\n","      <td>719</td>\n","      <td>957</td>\n","      <td>855</td>\n","      <td>650</td>\n","      <td>1016</td>\n","      <td>954</td>\n","      <td>619</td>\n","      <td>814</td>\n","      <td>988</td>\n","      <td>...</td>\n","      <td>308</td>\n","      <td>314</td>\n","      <td>344</td>\n","      <td>347</td>\n","      <td>319</td>\n","      <td>318</td>\n","      <td>307</td>\n","      <td>344</td>\n","      <td>367</td>\n","      <td>327</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ENSMUSG00000000003</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ENSMUSG00000000028</td>\n","      <td>95</td>\n","      <td>84</td>\n","      <td>175</td>\n","      <td>157</td>\n","      <td>245</td>\n","      <td>273</td>\n","      <td>111</td>\n","      <td>191</td>\n","      <td>280</td>\n","      <td>...</td>\n","      <td>16</td>\n","      <td>19</td>\n","      <td>23</td>\n","      <td>18</td>\n","      <td>11</td>\n","      <td>24</td>\n","      <td>22</td>\n","      <td>25</td>\n","      <td>21</td>\n","      <td>11</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ENSMUSG00000000031</td>\n","      <td>763</td>\n","      <td>244</td>\n","      <td>2743</td>\n","      <td>1030</td>\n","      <td>1926</td>\n","      <td>1290</td>\n","      <td>1321</td>\n","      <td>2383</td>\n","      <td>1108</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ENSMUSG00000000037</td>\n","      <td>17</td>\n","      <td>12</td>\n","      <td>41</td>\n","      <td>33</td>\n","      <td>46</td>\n","      <td>20</td>\n","      <td>18</td>\n","      <td>26</td>\n","      <td>25</td>\n","      <td>...</td>\n","      <td>20</td>\n","      <td>19</td>\n","      <td>10</td>\n","      <td>12</td>\n","      <td>12</td>\n","      <td>16</td>\n","      <td>8</td>\n","      <td>7</td>\n","      <td>14</td>\n","      <td>12</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 193 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-be2f78da-fb74-45d4-9d99-9f1b6116aed1')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-be2f78da-fb74-45d4-9d99-9f1b6116aed1 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-be2f78da-fb74-45d4-9d99-9f1b6116aed1');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-000b75bf-0b90-4b64-8085-82b21d1f871f\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-000b75bf-0b90-4b64-8085-82b21d1f871f')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-000b75bf-0b90-4b64-8085-82b21d1f871f button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe"}},"metadata":{},"execution_count":5}]},{"cell_type":"code","source":["metadata['457'] = m.pd.read_csv('mnt/My Drive/Colab Notebooks/Capstone/s_OSD-457.txt', sep='\\t', header=0)\n","print(metadata['457'])"],"metadata":{"id":"r3bmibxgfsDN","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1725752462481,"user_tz":240,"elapsed":368,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"f77e6921-6770-4831-dac2-c384598aa66a"},"id":"r3bmibxgfsDN","execution_count":6,"outputs":[{"output_type":"stream","name":"stdout","text":["    Source Name Sample Name Characteristics[Organism] Term Source REF  \\\n","0     MHU3_FL01  GSM4613909              Mus musculus       NCBITAXON   \n","1     MHU3_GC01  GSM4613910              Mus musculus       NCBITAXON   \n","2     MHU3_GC02  GSM4613912              Mus musculus       NCBITAXON   \n","3     MHU3_FL02  GSM4613911              Mus musculus       NCBITAXON   \n","4     MHU3_FL03  GSM4613913              Mus musculus       NCBITAXON   \n","..          ...         ...                       ...             ...   \n","187   MHU3_FL08  GSM4614096              Mus musculus       NCBITAXON   \n","188   MHU3_FL09  GSM4614097              Mus musculus       NCBITAXON   \n","189   MHU3_FL10  GSM4614098              Mus musculus       NCBITAXON   \n","190   MHU3_FL11  GSM4614099              Mus musculus       NCBITAXON   \n","191   MHU3_FL12  GSM4614100              Mus musculus       NCBITAXON   \n","\n","                                 Term Accession Number  \\\n","0    http://purl.bioontology.org/ontology/NCBITAXON...   \n","1    http://purl.bioontology.org/ontology/NCBITAXON...   \n","2    http://purl.bioontology.org/ontology/NCBITAXON...   \n","3    http://purl.bioontology.org/ontology/NCBITAXON...   \n","4    http://purl.bioontology.org/ontology/NCBITAXON...   \n","..                                                 ...   \n","187  http://purl.bioontology.org/ontology/NCBITAXON...   \n","188  http://purl.bioontology.org/ontology/NCBITAXON...   \n","189  http://purl.bioontology.org/ontology/NCBITAXON...   \n","190  http://purl.bioontology.org/ontology/NCBITAXON...   \n","191  http://purl.bioontology.org/ontology/NCBITAXON...   \n","\n","    Characteristics[Strain] Term Source REF.1  \\\n","0               C57BL/6NCrl               EFO   \n","1               C57BL/6NCrl               EFO   \n","2               C57BL/6NCrl               EFO   \n","3               C57BL/6NCrl               EFO   \n","4               C57BL/6NCrl               EFO   \n","..                      ...               ...   \n","187             C57BL/6NCrl               EFO   \n","188             C57BL/6NCrl               EFO   \n","189             C57BL/6NCrl               EFO   \n","190             C57BL/6NCrl               EFO   \n","191             C57BL/6NCrl               EFO   \n","\n","                  Term Accession Number.1 Characteristics[Animal Source]  \\\n","0    http://www.ebi.ac.uk/efo/EFO_0011030     Charles River Laboratories   \n","1    http://www.ebi.ac.uk/efo/EFO_0011030     Charles River Laboratories   \n","2    http://www.ebi.ac.uk/efo/EFO_0011030     Charles River Laboratories   \n","3    http://www.ebi.ac.uk/efo/EFO_0011030     Charles River Laboratories   \n","4    http://www.ebi.ac.uk/efo/EFO_0011030     Charles River Laboratories   \n","..                                    ...                            ...   \n","187  http://www.ebi.ac.uk/efo/EFO_0011030     Charles River Laboratories   \n","188  http://www.ebi.ac.uk/efo/EFO_0011030     Charles River Laboratories   \n","189  http://www.ebi.ac.uk/efo/EFO_0011030     Charles River Laboratories   \n","190  http://www.ebi.ac.uk/efo/EFO_0011030     Charles River Laboratories   \n","191  http://www.ebi.ac.uk/efo/EFO_0011030     Charles River Laboratories   \n","\n","     Characteristics[Age at launch]  ...  \\\n","0                                12  ...   \n","1                                12  ...   \n","2                                12  ...   \n","3                                12  ...   \n","4                                12  ...   \n","..                              ...  ...   \n","187                              12  ...   \n","188                              12  ...   \n","189                              12  ...   \n","190                              12  ...   \n","191                              12  ...   \n","\n","    Parameter Value[Sample Preservation Method] Term Source REF.18  \\\n","0                               Liquid Nitrogen               NCIT   \n","1                               Liquid Nitrogen               NCIT   \n","2                               Liquid Nitrogen               NCIT   \n","3                               Liquid Nitrogen               NCIT   \n","4                               Liquid Nitrogen               NCIT   \n","..                                          ...                ...   \n","187                             Liquid Nitrogen               NCIT   \n","188                             Liquid Nitrogen               NCIT   \n","189                             Liquid Nitrogen               NCIT   \n","190                             Liquid Nitrogen               NCIT   \n","191                             Liquid Nitrogen               NCIT   \n","\n","                       Term Accession Number.18  \\\n","0    http://purl.obolibrary.org/obo/NCIT_C68796   \n","1    http://purl.obolibrary.org/obo/NCIT_C68796   \n","2    http://purl.obolibrary.org/obo/NCIT_C68796   \n","3    http://purl.obolibrary.org/obo/NCIT_C68796   \n","4    http://purl.obolibrary.org/obo/NCIT_C68796   \n","..                                          ...   \n","187  http://purl.obolibrary.org/obo/NCIT_C68796   \n","188  http://purl.obolibrary.org/obo/NCIT_C68796   \n","189  http://purl.obolibrary.org/obo/NCIT_C68796   \n","190  http://purl.obolibrary.org/obo/NCIT_C68796   \n","191  http://purl.obolibrary.org/obo/NCIT_C68796   \n","\n","    Parameter Value[Euthanasia Method] Term Source REF.19  \\\n","0                       Exsanguination               MESH   \n","1                       Exsanguination               MESH   \n","2                       Exsanguination               MESH   \n","3                       Exsanguination               MESH   \n","4                       Exsanguination               MESH   \n","..                                 ...                ...   \n","187                     Exsanguination               MESH   \n","188                     Exsanguination               MESH   \n","189                     Exsanguination               MESH   \n","190                     Exsanguination               MESH   \n","191                     Exsanguination               MESH   \n","\n","                              Term Accession Number.19  \\\n","0    http://purl.bioontology.org/ontology/MESH/D058734   \n","1    http://purl.bioontology.org/ontology/MESH/D058734   \n","2    http://purl.bioontology.org/ontology/MESH/D058734   \n","3    http://purl.bioontology.org/ontology/MESH/D058734   \n","4    http://purl.bioontology.org/ontology/MESH/D058734   \n","..                                                 ...   \n","187  http://purl.bioontology.org/ontology/MESH/D058734   \n","188  http://purl.bioontology.org/ontology/MESH/D058734   \n","189  http://purl.bioontology.org/ontology/MESH/D058734   \n","190  http://purl.bioontology.org/ontology/MESH/D058734   \n","191  http://purl.bioontology.org/ontology/MESH/D058734   \n","\n","    Parameter Value[Sample Storage Temperature]          Unit.6  \\\n","0                                           -80  degree Celsius   \n","1                                           -80  degree Celsius   \n","2                                           -80  degree Celsius   \n","3                                           -80  degree Celsius   \n","4                                           -80  degree Celsius   \n","..                                          ...             ...   \n","187                                         -80  degree Celsius   \n","188                                         -80  degree Celsius   \n","189                                         -80  degree Celsius   \n","190                                         -80  degree Celsius   \n","191                                         -80  degree Celsius   \n","\n","    Term Source REF.20                   Term Accession Number.20  \n","0                   UO  http://purl.obolibrary.org/obo/UO_0000027  \n","1                   UO  http://purl.obolibrary.org/obo/UO_0000027  \n","2                   UO  http://purl.obolibrary.org/obo/UO_0000027  \n","3                   UO  http://purl.obolibrary.org/obo/UO_0000027  \n","4                   UO  http://purl.obolibrary.org/obo/UO_0000027  \n","..                 ...                                        ...  \n","187                 UO  http://purl.obolibrary.org/obo/UO_0000027  \n","188                 UO  http://purl.obolibrary.org/obo/UO_0000027  \n","189                 UO  http://purl.obolibrary.org/obo/UO_0000027  \n","190                 UO  http://purl.obolibrary.org/obo/UO_0000027  \n","191                 UO  http://purl.obolibrary.org/obo/UO_0000027  \n","\n","[192 rows x 77 columns]\n"]}]},{"cell_type":"markdown","source":["## Filter data"],"metadata":{"id":"PBSIAKdIfjmD"},"id":"PBSIAKdIfjmD"},{"cell_type":"code","source":["# filter out non-protein coding genes and genes with NaN values\n","print('shape before filtering: ', data['457-unormalized'].shape)\n","rna_seq = m.filter_data(data['457-unormalized'], dropnans=True, dropgenes=None, droplowcvs=0, droplowcount=10)\n","# Output the filtered dataframe\n","print('shape after filtering: ', rna_seq.shape)\n","rna_seq.head()"],"metadata":{"id":"a8Dn9Svor6J-","colab":{"base_uri":"https://localhost:8080/","height":308},"executionInfo":{"status":"ok","timestamp":1725752462637,"user_tz":240,"elapsed":159,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"a5fca3d0-e5d7-4438-8e60-5cf986f1aef4"},"id":"a8Dn9Svor6J-","execution_count":7,"outputs":[{"output_type":"stream","name":"stdout","text":["shape before filtering:  (56748, 193)\n","56748\n","shape after filtering:  (35149, 193)\n"]},{"output_type":"execute_result","data":{"text/plain":["           Unnamed: 0  GSM4613909  GSM4613910  GSM4613911  GSM4613912  \\\n","0  ENSMUSG00000000001         719         957         855         650   \n","1  ENSMUSG00000000003           0           0           0           0   \n","2  ENSMUSG00000000028          95          84         175         157   \n","3  ENSMUSG00000000031         763         244        2743        1030   \n","4  ENSMUSG00000000037          17          12          41          33   \n","\n","   GSM4613913  GSM4613914  GSM4613915  GSM4613916  GSM4613917  ...  \\\n","0        1016         954         619         814         988  ...   \n","1           0           0           0           0           0  ...   \n","2         245         273         111         191         280  ...   \n","3        1926        1290        1321        2383        1108  ...   \n","4          46          20          18          26          25  ...   \n","\n","   GSM4614091  GSM4614092  GSM4614093  GSM4614094  GSM4614095  GSM4614096  \\\n","0         308         314         344         347         319         318   \n","1           0           0           0           0           0           0   \n","2          16          19          23          18          11          24   \n","3           0           0           0           0           0           1   \n","4          20          19          10          12          12          16   \n","\n","   GSM4614097  GSM4614098  GSM4614099  GSM4614100  \n","0         307         344         367         327  \n","1           0           0           0           0  \n","2          22          25          21          11  \n","3           1           1           1           3  \n","4           8           7          14          12  \n","\n","[5 rows x 193 columns]"],"text/html":["\n","  <div id=\"df-a452bb68-b871-4ac0-918e-ef4313d2b824\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>GSM4613909</th>\n","      <th>GSM4613910</th>\n","      <th>GSM4613911</th>\n","      <th>GSM4613912</th>\n","      <th>GSM4613913</th>\n","      <th>GSM4613914</th>\n","      <th>GSM4613915</th>\n","      <th>GSM4613916</th>\n","      <th>GSM4613917</th>\n","      <th>...</th>\n","      <th>GSM4614091</th>\n","      <th>GSM4614092</th>\n","      <th>GSM4614093</th>\n","      <th>GSM4614094</th>\n","      <th>GSM4614095</th>\n","      <th>GSM4614096</th>\n","      <th>GSM4614097</th>\n","      <th>GSM4614098</th>\n","      <th>GSM4614099</th>\n","      <th>GSM4614100</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ENSMUSG00000000001</td>\n","      <td>719</td>\n","      <td>957</td>\n","      <td>855</td>\n","      <td>650</td>\n","      <td>1016</td>\n","      <td>954</td>\n","      <td>619</td>\n","      <td>814</td>\n","      <td>988</td>\n","      <td>...</td>\n","      <td>308</td>\n","      <td>314</td>\n","      <td>344</td>\n","      <td>347</td>\n","      <td>319</td>\n","      <td>318</td>\n","      <td>307</td>\n","      <td>344</td>\n","      <td>367</td>\n","      <td>327</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ENSMUSG00000000003</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ENSMUSG00000000028</td>\n","      <td>95</td>\n","      <td>84</td>\n","      <td>175</td>\n","      <td>157</td>\n","      <td>245</td>\n","      <td>273</td>\n","      <td>111</td>\n","      <td>191</td>\n","      <td>280</td>\n","      <td>...</td>\n","      <td>16</td>\n","      <td>19</td>\n","      <td>23</td>\n","      <td>18</td>\n","      <td>11</td>\n","      <td>24</td>\n","      <td>22</td>\n","      <td>25</td>\n","      <td>21</td>\n","      <td>11</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ENSMUSG00000000031</td>\n","      <td>763</td>\n","      <td>244</td>\n","      <td>2743</td>\n","      <td>1030</td>\n","      <td>1926</td>\n","      <td>1290</td>\n","      <td>1321</td>\n","      <td>2383</td>\n","      <td>1108</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ENSMUSG00000000037</td>\n","      <td>17</td>\n","      <td>12</td>\n","      <td>41</td>\n","      <td>33</td>\n","      <td>46</td>\n","      <td>20</td>\n","      <td>18</td>\n","      <td>26</td>\n","      <td>25</td>\n","      <td>...</td>\n","      <td>20</td>\n","      <td>19</td>\n","      <td>10</td>\n","      <td>12</td>\n","      <td>12</td>\n","      <td>16</td>\n","      <td>8</td>\n","      <td>7</td>\n","      <td>14</td>\n","      <td>12</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 193 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a452bb68-b871-4ac0-918e-ef4313d2b824')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-a452bb68-b871-4ac0-918e-ef4313d2b824 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-a452bb68-b871-4ac0-918e-ef4313d2b824');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-bd012002-c16c-4c1c-9952-a5c331f908e8\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-bd012002-c16c-4c1c-9952-a5c331f908e8')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-bd012002-c16c-4c1c-9952-a5c331f908e8 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"rna_seq"}},"metadata":{},"execution_count":7}]},{"cell_type":"code","source":["columns_to_keep = [0, 123, 125, 126, 127, 128, 130, 135, 137, 138, 139, 140, 142]\n","rna_seq = rna_seq.iloc[:, columns_to_keep]\n","print('shape after filtering: ', rna_seq.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_Za41MOOU3VU","executionInfo":{"status":"ok","timestamp":1725752462638,"user_tz":240,"elapsed":15,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"7bce217a-0dac-4329-8411-0453a750dfe6"},"id":"_Za41MOOU3VU","execution_count":8,"outputs":[{"output_type":"stream","name":"stdout","text":["shape after filtering:  (35149, 13)\n"]}]},{"cell_type":"code","source":["print(rna_seq)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"FuISj343VG1l","executionInfo":{"status":"ok","timestamp":1725752462638,"user_tz":240,"elapsed":13,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"0bb361ea-0650-4c4f-8674-3f2c2fe6e5e5"},"id":"FuISj343VG1l","execution_count":9,"outputs":[{"output_type":"stream","name":"stdout","text":["               Unnamed: 0  GSM4614031  GSM4614033  GSM4614034  GSM4614035  \\\n","0      ENSMUSG00000000001        1497        1255        1378        1526   \n","1      ENSMUSG00000000003           0           0           0           0   \n","2      ENSMUSG00000000028         418         294         285         411   \n","3      ENSMUSG00000000031          41          34          60          42   \n","4      ENSMUSG00000000037          11           7          14          16   \n","...                   ...         ...         ...         ...         ...   \n","56712  ENSMUSG00002076957           0           1           0           0   \n","56723  ENSMUSG00002076968           0           1           1           0   \n","56732  ENSMUSG00002076977           0           0           0           0   \n","56736  ENSMUSG00002076981           0           0           1           0   \n","56738  ENSMUSG00002076983           1           1           4           0   \n","\n","       GSM4614036  GSM4614038  GSM4614043  GSM4614045  GSM4614046  GSM4614047  \\\n","0            1443        1539        1659        1940        1572        1597   \n","1               0           0           0           0           0           0   \n","2             356         439         472         468         407         426   \n","3              40          36          50          31          36          25   \n","4              16          11          12          10          21          24   \n","...           ...         ...         ...         ...         ...         ...   \n","56712           1           1           1           1           1           1   \n","56723           1           0           0           1           1           0   \n","56732           0           0           0           0           0           0   \n","56736           0           0           0           0           0           0   \n","56738           1           1           1           0           2           1   \n","\n","       GSM4614048  GSM4614050  \n","0            1777        1576  \n","1               0           0  \n","2             481         356  \n","3              52          33  \n","4              11          10  \n","...           ...         ...  \n","56712           2           1  \n","56723           0           0  \n","56732           0           0  \n","56736           0           0  \n","56738           0           1  \n","\n","[35149 rows x 13 columns]\n"]}]},{"cell_type":"code","source":["print('shape before transpose: ', rna_seq.shape)\n","rna_seq = m.transpose_df(rna_seq, cur_index_col='Unnamed: 0', new_index_col = 'sample')\n","print('shape after transpose: ', rna_seq.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"h0cwz-Vbs7v1","executionInfo":{"status":"ok","timestamp":1725752462638,"user_tz":240,"elapsed":11,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"8b321b51-4d67-45ec-cfe7-e25a68d1f78a"},"id":"h0cwz-Vbs7v1","execution_count":10,"outputs":[{"output_type":"stream","name":"stdout","text":["shape before transpose:  (35149, 13)\n","shape after transpose:  (12, 35150)\n"]}]},{"cell_type":"code","source":["rna_seq.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":256},"id":"KsIRXTXEs-qM","executionInfo":{"status":"ok","timestamp":1725752462638,"user_tz":240,"elapsed":8,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"abd1d96a-4481-4529-fed4-81f5d4c482bd"},"id":"KsIRXTXEs-qM","execution_count":11,"outputs":[{"output_type":"execute_result","data":{"text/plain":["       sample  ENSMUSG00000000001  ENSMUSG00000000003  ENSMUSG00000000028  \\\n","0  GSM4614031                1497                   0                 418   \n","1  GSM4614033                1255                   0                 294   \n","2  GSM4614034                1378                   0                 285   \n","3  GSM4614035                1526                   0                 411   \n","4  GSM4614036                1443                   0                 356   \n","\n","   ENSMUSG00000000031  ENSMUSG00000000037  ENSMUSG00000000049  \\\n","0                  41                  11                  10   \n","1                  34                   7                  12   \n","2                  60                  14                   5   \n","3                  42                  16                   8   \n","4                  40                  16                   8   \n","\n","   ENSMUSG00000000056  ENSMUSG00000000058  ENSMUSG00000000078  ...  \\\n","0                1076                  40                 842  ...   \n","1                1043                  38                 769  ...   \n","2                 935                  33                 869  ...   \n","3                1035                  42                 842  ...   \n","4                 933                  27                 835  ...   \n","\n","   ENSMUSG00002076945  ENSMUSG00002076948  ENSMUSG00002076951  \\\n","0                   0                   0                   0   \n","1                   0                   0                   0   \n","2                   0                   0                   0   \n","3                   0                   0                   0   \n","4                   0                   0                   1   \n","\n","   ENSMUSG00002076954  ENSMUSG00002076956  ENSMUSG00002076957  \\\n","0                   2                   2                   0   \n","1                   0                   2                   1   \n","2                   0                   1                   0   \n","3                   3                   4                   0   \n","4                   1                   1                   1   \n","\n","   ENSMUSG00002076968  ENSMUSG00002076977  ENSMUSG00002076981  \\\n","0                   0                   0                   0   \n","1                   1                   0                   0   \n","2                   1                   0                   1   \n","3                   0                   0                   0   \n","4                   1                   0                   0   \n","\n","   ENSMUSG00002076983  \n","0                   1  \n","1                   1  \n","2                   4  \n","3                   0  \n","4                   1  \n","\n","[5 rows x 35150 columns]"],"text/html":["\n","  <div id=\"df-76c6c40b-112f-48a8-b6eb-b52a3a4b37b6\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>sample</th>\n","      <th>ENSMUSG00000000001</th>\n","      <th>ENSMUSG00000000003</th>\n","      <th>ENSMUSG00000000028</th>\n","      <th>ENSMUSG00000000031</th>\n","      <th>ENSMUSG00000000037</th>\n","      <th>ENSMUSG00000000049</th>\n","      <th>ENSMUSG00000000056</th>\n","      <th>ENSMUSG00000000058</th>\n","      <th>ENSMUSG00000000078</th>\n","      <th>...</th>\n","      <th>ENSMUSG00002076945</th>\n","      <th>ENSMUSG00002076948</th>\n","      <th>ENSMUSG00002076951</th>\n","      <th>ENSMUSG00002076954</th>\n","      <th>ENSMUSG00002076956</th>\n","      <th>ENSMUSG00002076957</th>\n","      <th>ENSMUSG00002076968</th>\n","      <th>ENSMUSG00002076977</th>\n","      <th>ENSMUSG00002076981</th>\n","      <th>ENSMUSG00002076983</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>GSM4614031</td>\n","      <td>1497</td>\n","      <td>0</td>\n","      <td>418</td>\n","      <td>41</td>\n","      <td>11</td>\n","      <td>10</td>\n","      <td>1076</td>\n","      <td>40</td>\n","      <td>842</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>GSM4614033</td>\n","      <td>1255</td>\n","      <td>0</td>\n","      <td>294</td>\n","      <td>34</td>\n","      <td>7</td>\n","      <td>12</td>\n","      <td>1043</td>\n","      <td>38</td>\n","      <td>769</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>GSM4614034</td>\n","      <td>1378</td>\n","      <td>0</td>\n","      <td>285</td>\n","      <td>60</td>\n","      <td>14</td>\n","      <td>5</td>\n","      <td>935</td>\n","      <td>33</td>\n","      <td>869</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>GSM4614035</td>\n","      <td>1526</td>\n","      <td>0</td>\n","      <td>411</td>\n","      <td>42</td>\n","      <td>16</td>\n","      <td>8</td>\n","      <td>1035</td>\n","      <td>42</td>\n","      <td>842</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>GSM4614036</td>\n","      <td>1443</td>\n","      <td>0</td>\n","      <td>356</td>\n","      <td>40</td>\n","      <td>16</td>\n","      <td>8</td>\n","      <td>933</td>\n","      <td>27</td>\n","      <td>835</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 35150 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-76c6c40b-112f-48a8-b6eb-b52a3a4b37b6')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-76c6c40b-112f-48a8-b6eb-b52a3a4b37b6 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-76c6c40b-112f-48a8-b6eb-b52a3a4b37b6');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-06500a04-1b95-4c32-9140-804d44e4c80b\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-06500a04-1b95-4c32-9140-804d44e4c80b')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-06500a04-1b95-4c32-9140-804d44e4c80b button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"rna_seq"}},"metadata":{},"execution_count":11}]},{"cell_type":"markdown","source":["# Perform differential gene expression analysis\n","\n","We are using the [PyDESeq2](https://pydeseq2.readthedocs.io/en/latest/index.html) implementation of DESeq2 to perform differential gene expression analysis to see if there's a significant difference in gene expression between the ground control and spaceflight samples.  The tool requires our data to be in a particular format, so after we read in the data from OSDR, we'll perform some steps to transform the data accordingly."],"metadata":{"id":"s1M2vDnogde0"},"id":"s1M2vDnogde0"},{"cell_type":"code","execution_count":12,"id":"00429871-be11-4ea6-b44f-ab65e40676c1","metadata":{"id":"00429871-be11-4ea6-b44f-ab65e40676c1","colab":{"base_uri":"https://localhost:8080/","height":426},"executionInfo":{"status":"ok","timestamp":1725752462935,"user_tz":240,"elapsed":303,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"82f0bd41-35c7-4022-8161-2cca199af123"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["        sample  condition\n","0   GSM4614031          1\n","1   GSM4614033          1\n","2   GSM4614034          1\n","3   GSM4614035          1\n","4   GSM4614036          1\n","5   GSM4614038          1\n","6   GSM4614043          0\n","7   GSM4614045          0\n","8   GSM4614046          0\n","9   GSM4614047          0\n","10  GSM4614048          0\n","11  GSM4614050          0"],"text/html":["\n","  <div id=\"df-a03b167a-052e-460f-9791-0632f8d143eb\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>sample</th>\n","      <th>condition</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>GSM4614031</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>GSM4614033</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>GSM4614034</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>GSM4614035</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>GSM4614036</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>GSM4614038</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>GSM4614043</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>GSM4614045</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>GSM4614046</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>GSM4614047</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>GSM4614048</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>GSM4614050</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a03b167a-052e-460f-9791-0632f8d143eb')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-a03b167a-052e-460f-9791-0632f8d143eb button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-a03b167a-052e-460f-9791-0632f8d143eb');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-96d35a4a-5897-4577-9b71-0eadf615b9b1\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-96d35a4a-5897-4577-9b71-0eadf615b9b1')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-96d35a4a-5897-4577-9b71-0eadf615b9b1 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","  <div id=\"id_871ea151-a369-49ac-99e3-46b88e71b772\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('conditions')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_871ea151-a369-49ac-99e3-46b88e71b772 button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('conditions');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"conditions","summary":"{\n  \"name\": \"conditions\",\n  \"rows\": 12,\n  \"fields\": [\n    {\n      \"column\": \"sample\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 12,\n        \"samples\": [\n          \"GSM4614048\",\n          \"GSM4614047\",\n          \"GSM4614031\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"condition\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 0,\n        \"max\": 1,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          0,\n          1\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":12}],"source":["# First let's create a conditions table for 'Factor Value: Spaceflight'. We'll assign 0 for ground control and 1 for spaceflight\n","condition_dict=dict()\n","for sample in list(rna_seq['sample']):\n","    val=metadata['457'][metadata['457']['Sample Name']==sample]['Factor Value[Spaceflight]'].values[0]\n","    if val == 'Space Flight':\n","        condition_dict[sample] = 1\n","    else:\n","        condition_dict[sample] = 0\n","rna_seq[\"condition\"] = rna_seq[\"sample\"].map(condition_dict)\n","conditions=rna_seq[['sample', 'condition']]\n","conditions"]},{"cell_type":"code","execution_count":13,"id":"27904330-57d9-41c1-bc9f-9e35473a0506","metadata":{"id":"27904330-57d9-41c1-bc9f-9e35473a0506","colab":{"base_uri":"https://localhost:8080/","height":256},"executionInfo":{"status":"ok","timestamp":1725752464772,"user_tz":240,"elapsed":1844,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"50cbed49-5570-4b7e-e5b1-eac8f21293dd"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   ENSMUSG00000000001  ENSMUSG00000000003  ENSMUSG00000000028  \\\n","0                1497                   0                 418   \n","1                1255                   0                 294   \n","2                1378                   0                 285   \n","3                1526                   0                 411   \n","4                1443                   0                 356   \n","\n","   ENSMUSG00000000031  ENSMUSG00000000037  ENSMUSG00000000049  \\\n","0                  41                  11                  10   \n","1                  34                   7                  12   \n","2                  60                  14                   5   \n","3                  42                  16                   8   \n","4                  40                  16                   8   \n","\n","   ENSMUSG00000000056  ENSMUSG00000000058  ENSMUSG00000000078  \\\n","0                1076                  40                 842   \n","1                1043                  38                 769   \n","2                 935                  33                 869   \n","3                1035                  42                 842   \n","4                 933                  27                 835   \n","\n","   ENSMUSG00000000085  ...  ENSMUSG00002076945  ENSMUSG00002076948  \\\n","0                 387  ...                   0                   0   \n","1                 368  ...                   0                   0   \n","2                 403  ...                   0                   0   \n","3                 319  ...                   0                   0   \n","4                 390  ...                   0                   0   \n","\n","   ENSMUSG00002076951  ENSMUSG00002076954  ENSMUSG00002076956  \\\n","0                   0                   2                   2   \n","1                   0                   0                   2   \n","2                   0                   0                   1   \n","3                   0                   3                   4   \n","4                   1                   1                   1   \n","\n","   ENSMUSG00002076957  ENSMUSG00002076968  ENSMUSG00002076977  \\\n","0                   0                   0                   0   \n","1                   1                   1                   0   \n","2                   0                   1                   0   \n","3                   0                   0                   0   \n","4                   1                   1                   0   \n","\n","   ENSMUSG00002076981  ENSMUSG00002076983  \n","0                   0                   1  \n","1                   0                   1  \n","2                   1                   4  \n","3                   0                   0  \n","4                   0                   1  \n","\n","[5 rows x 35149 columns]"],"text/html":["\n","  <div id=\"df-1d0b7781-d9cf-409b-b156-49435779d5e4\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ENSMUSG00000000001</th>\n","      <th>ENSMUSG00000000003</th>\n","      <th>ENSMUSG00000000028</th>\n","      <th>ENSMUSG00000000031</th>\n","      <th>ENSMUSG00000000037</th>\n","      <th>ENSMUSG00000000049</th>\n","      <th>ENSMUSG00000000056</th>\n","      <th>ENSMUSG00000000058</th>\n","      <th>ENSMUSG00000000078</th>\n","      <th>ENSMUSG00000000085</th>\n","      <th>...</th>\n","      <th>ENSMUSG00002076945</th>\n","      <th>ENSMUSG00002076948</th>\n","      <th>ENSMUSG00002076951</th>\n","      <th>ENSMUSG00002076954</th>\n","      <th>ENSMUSG00002076956</th>\n","      <th>ENSMUSG00002076957</th>\n","      <th>ENSMUSG00002076968</th>\n","      <th>ENSMUSG00002076977</th>\n","      <th>ENSMUSG00002076981</th>\n","      <th>ENSMUSG00002076983</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1497</td>\n","      <td>0</td>\n","      <td>418</td>\n","      <td>41</td>\n","      <td>11</td>\n","      <td>10</td>\n","      <td>1076</td>\n","      <td>40</td>\n","      <td>842</td>\n","      <td>387</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1255</td>\n","      <td>0</td>\n","      <td>294</td>\n","      <td>34</td>\n","      <td>7</td>\n","      <td>12</td>\n","      <td>1043</td>\n","      <td>38</td>\n","      <td>769</td>\n","      <td>368</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1378</td>\n","      <td>0</td>\n","      <td>285</td>\n","      <td>60</td>\n","      <td>14</td>\n","      <td>5</td>\n","      <td>935</td>\n","      <td>33</td>\n","      <td>869</td>\n","      <td>403</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1526</td>\n","      <td>0</td>\n","      <td>411</td>\n","      <td>42</td>\n","      <td>16</td>\n","      <td>8</td>\n","      <td>1035</td>\n","      <td>42</td>\n","      <td>842</td>\n","      <td>319</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1443</td>\n","      <td>0</td>\n","      <td>356</td>\n","      <td>40</td>\n","      <td>16</td>\n","      <td>8</td>\n","      <td>933</td>\n","      <td>27</td>\n","      <td>835</td>\n","      <td>390</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 35149 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1d0b7781-d9cf-409b-b156-49435779d5e4')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-1d0b7781-d9cf-409b-b156-49435779d5e4 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-1d0b7781-d9cf-409b-b156-49435779d5e4');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-e88255e3-ae45-4880-a3e3-9240bc67a0bf\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-e88255e3-ae45-4880-a3e3-9240bc67a0bf')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-e88255e3-ae45-4880-a3e3-9240bc67a0bf button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"counts"}},"metadata":{},"execution_count":13}],"source":["# remove sample and condition from rna_seq dataframe\n","counts=rna_seq.drop(columns=['sample', 'condition']).reset_index(drop=True)\n","# check for non-numeric\n","counts.applymap(m.np.isreal)\n","# convert all cells to integers\n","counts=counts.astype(int)\n","counts.head()"]},{"cell_type":"code","execution_count":14,"id":"49bb64e5-b19b-4473-8380-7bb7f170f782","metadata":{"id":"49bb64e5-b19b-4473-8380-7bb7f170f782","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1725752620648,"user_tz":240,"elapsed":155878,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"6ad75742-a4e6-4e3a-eb00-fd8bfce9d072"},"outputs":[{"output_type":"stream","name":"stderr","text":["Fitting size factors...\n","... done in 0.03 seconds.\n","\n","Fitting dispersions...\n","... done in 37.20 seconds.\n","\n","Fitting dispersion trend curve...\n","... done in 0.96 seconds.\n","\n","Fitting MAP dispersions...\n","... done in 51.68 seconds.\n","\n","Fitting LFCs...\n","... done in 25.71 seconds.\n","\n","Calculating cook's distance...\n","... done in 0.05 seconds.\n","\n","Replacing 0 outlier genes.\n","\n","Running Wald tests...\n","... done in 8.47 seconds.\n","\n"]},{"output_type":"stream","name":"stdout","text":["Log2 fold change & Wald test p-value: condition 0 vs 1\n","                       baseMean  log2FoldChange     lfcSE      stat  \\\n","ENSMUSG00000000001  1551.692281        0.260507  0.052296  4.981440   \n","ENSMUSG00000000003     0.000000             NaN       NaN       NaN   \n","ENSMUSG00000000028   398.172311        0.278807  0.104288  2.673427   \n","ENSMUSG00000000031    39.693297       -0.121693  0.200162 -0.607974   \n","ENSMUSG00000000037    13.588398        0.271125  0.320419  0.846158   \n","...                         ...             ...       ...       ...   \n","ENSMUSG00002076957     0.831770        1.253398  1.172555  1.068946   \n","ENSMUSG00002076968     0.412833       -0.451902  1.661440 -0.271994   \n","ENSMUSG00002076977     0.000000             NaN       NaN       NaN   \n","ENSMUSG00002076981     0.081106       -0.446535  3.400487 -0.131315   \n","ENSMUSG00002076983     1.081897       -0.626809  1.043405 -0.600735   \n","\n","                          pvalue      padj  \n","ENSMUSG00000000001  6.311300e-07  0.000020  \n","ENSMUSG00000000003           NaN       NaN  \n","ENSMUSG00000000028  7.508070e-03  0.035218  \n","ENSMUSG00000000031  5.432044e-01  0.698161  \n","ENSMUSG00000000037  3.974647e-01  0.575095  \n","...                          ...       ...  \n","ENSMUSG00002076957  2.850940e-01       NaN  \n","ENSMUSG00002076968  7.856266e-01       NaN  \n","ENSMUSG00002076977           NaN       NaN  \n","ENSMUSG00002076981  8.955262e-01       NaN  \n","ENSMUSG00002076983  5.480168e-01       NaN  \n","\n","[35149 rows x 6 columns]\n"]}],"source":["# run the DESEq2 experiment contrasting conditin \"0\" (ground control) to condition \"1\" (spaceflight)\n","dds=m.DeseqDataSet(counts=counts, metadata=conditions, design_factors=\"condition\")\n","dds.deseq2()\n","stats_results = m.DeseqStats(dds, contrast = ('condition', '0', '1'))\n","stats_results.summary()\n","res = stats_results.results_df"]},{"cell_type":"code","source":["# extract results of the DESeq2 experiment where  padj < 0.05, and log2fc > 0\n","#res = res[res.baseMean >= 10000]\n","sigs = res[(res.padj < 0.05) & (abs(res.log2FoldChange) > 0)]\n","gene_list=list(sigs.index)\n","print(len(gene_list))"],"metadata":{"id":"IJUv4VHVKXK0","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1725752620649,"user_tz":240,"elapsed":17,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"6582f5c4-63d8-4978-d1d7-043187f757e0"},"id":"IJUv4VHVKXK0","execution_count":15,"outputs":[{"output_type":"stream","name":"stdout","text":["3648\n"]}]},{"cell_type":"code","source":["# use m.read_rnaseq_data() to read in the normalized transcriptomic counts from OSD-457\n","data['457-normalized'] = m.read_rnaseq_data('457_rna_seq_Normalized_Counts')\n","rna_seq_normalized = data['457-normalized']"],"metadata":{"id":"2INL-S_XyuI0","executionInfo":{"status":"ok","timestamp":1725752625452,"user_tz":240,"elapsed":4806,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}}},"id":"2INL-S_XyuI0","execution_count":16,"outputs":[]},{"cell_type":"code","source":["# Keep the first column and filter the rest based on the gene_list\n","rna_seq_deg = rna_seq_normalized[rna_seq_normalized.iloc[:, 0].isin(gene_list)]\n","rna_seq_deg.shape"],"metadata":{"id":"AmkdWw0YreBg","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1725752625460,"user_tz":240,"elapsed":23,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"837570c9-8caf-4455-cf59-d8d8ca440bfc"},"id":"AmkdWw0YreBg","execution_count":17,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(3629, 193)"]},"metadata":{},"execution_count":17}]},{"cell_type":"code","source":["rna_seq_deg.head()"],"metadata":{"id":"4IkODOnwuEep","colab":{"base_uri":"https://localhost:8080/","height":256},"executionInfo":{"status":"ok","timestamp":1725752625460,"user_tz":240,"elapsed":22,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"ff5aa372-6c3d-4915-f51d-da55148c3499"},"id":"4IkODOnwuEep","execution_count":18,"outputs":[{"output_type":"execute_result","data":{"text/plain":["            Unnamed: 0  GSM4613909  GSM4613910   GSM4613912   GSM4613911  \\\n","0   ENSMUSG00000000001  531.799293  666.098956   472.376024   621.176539   \n","1   ENSMUSG00000000028   66.896337   47.230064   102.910370   128.290282   \n","5   ENSMUSG00000000056  787.952006  741.983630  1168.934273   718.944340   \n","7   ENSMUSG00000000078  737.991790  787.752772   729.043939  1072.426562   \n","29  ENSMUSG00000000184  351.536620  915.607489   467.296232   724.542948   \n","\n","     GSM4613913   GSM4613914  GSM4613915  GSM4613916  GSM4613917  ...  \\\n","0    714.239627   655.153477  460.846405  650.228290  663.637586  ...   \n","1    164.384364   174.525093   77.518105  136.270860  181.385240  ...   \n","5    839.863625  1075.505114  687.736010  965.843537  768.756413  ...   \n","7   1044.013150   711.321620  802.769883  947.100234  795.485804  ...   \n","29   948.481301   603.649435  488.247835  804.568953  731.395917  ...   \n","\n","     GSM4614091   GSM4614092   GSM4614093   GSM4614094   GSM4614095  \\\n","0    304.137653   308.378075   326.938171   349.489345   296.213301   \n","1     16.070776    27.652822    27.332098    18.718212    15.984246   \n","5    647.970746   673.877946   665.873120   557.745477   685.339739   \n","7    578.502305   545.142637   601.629071   672.624186   507.960175   \n","29  1380.233750  1199.935689  1144.263772  1211.185111  1161.553496   \n","\n","     GSM4614096   GSM4614097   GSM4614098   GSM4614099   GSM4614100  \n","0    299.850589   284.772295   330.033275   339.079602   324.467550  \n","1     21.458197    18.481422    30.366054    17.202049    13.987852  \n","5    642.766707   485.830933   673.308761   606.485626   576.939241  \n","7    559.959017   522.323511   573.081073   530.144772   608.174840  \n","29  1282.170310  1200.451420  1300.962202  1218.994056  1387.911446  \n","\n","[5 rows x 193 columns]"],"text/html":["\n","  <div id=\"df-85ef8c5c-8980-4c25-9b59-8f38d1bebb8c\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>GSM4613909</th>\n","      <th>GSM4613910</th>\n","      <th>GSM4613912</th>\n","      <th>GSM4613911</th>\n","      <th>GSM4613913</th>\n","      <th>GSM4613914</th>\n","      <th>GSM4613915</th>\n","      <th>GSM4613916</th>\n","      <th>GSM4613917</th>\n","      <th>...</th>\n","      <th>GSM4614091</th>\n","      <th>GSM4614092</th>\n","      <th>GSM4614093</th>\n","      <th>GSM4614094</th>\n","      <th>GSM4614095</th>\n","      <th>GSM4614096</th>\n","      <th>GSM4614097</th>\n","      <th>GSM4614098</th>\n","      <th>GSM4614099</th>\n","      <th>GSM4614100</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ENSMUSG00000000001</td>\n","      <td>531.799293</td>\n","      <td>666.098956</td>\n","      <td>472.376024</td>\n","      <td>621.176539</td>\n","      <td>714.239627</td>\n","      <td>655.153477</td>\n","      <td>460.846405</td>\n","      <td>650.228290</td>\n","      <td>663.637586</td>\n","      <td>...</td>\n","      <td>304.137653</td>\n","      <td>308.378075</td>\n","      <td>326.938171</td>\n","      <td>349.489345</td>\n","      <td>296.213301</td>\n","      <td>299.850589</td>\n","      <td>284.772295</td>\n","      <td>330.033275</td>\n","      <td>339.079602</td>\n","      <td>324.467550</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ENSMUSG00000000028</td>\n","      <td>66.896337</td>\n","      <td>47.230064</td>\n","      <td>102.910370</td>\n","      <td>128.290282</td>\n","      <td>164.384364</td>\n","      <td>174.525093</td>\n","      <td>77.518105</td>\n","      <td>136.270860</td>\n","      <td>181.385240</td>\n","      <td>...</td>\n","      <td>16.070776</td>\n","      <td>27.652822</td>\n","      <td>27.332098</td>\n","      <td>18.718212</td>\n","      <td>15.984246</td>\n","      <td>21.458197</td>\n","      <td>18.481422</td>\n","      <td>30.366054</td>\n","      <td>17.202049</td>\n","      <td>13.987852</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>ENSMUSG00000000056</td>\n","      <td>787.952006</td>\n","      <td>741.983630</td>\n","      <td>1168.934273</td>\n","      <td>718.944340</td>\n","      <td>839.863625</td>\n","      <td>1075.505114</td>\n","      <td>687.736010</td>\n","      <td>965.843537</td>\n","      <td>768.756413</td>\n","      <td>...</td>\n","      <td>647.970746</td>\n","      <td>673.877946</td>\n","      <td>665.873120</td>\n","      <td>557.745477</td>\n","      <td>685.339739</td>\n","      <td>642.766707</td>\n","      <td>485.830933</td>\n","      <td>673.308761</td>\n","      <td>606.485626</td>\n","      <td>576.939241</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>ENSMUSG00000000078</td>\n","      <td>737.991790</td>\n","      <td>787.752772</td>\n","      <td>729.043939</td>\n","      <td>1072.426562</td>\n","      <td>1044.013150</td>\n","      <td>711.321620</td>\n","      <td>802.769883</td>\n","      <td>947.100234</td>\n","      <td>795.485804</td>\n","      <td>...</td>\n","      <td>578.502305</td>\n","      <td>545.142637</td>\n","      <td>601.629071</td>\n","      <td>672.624186</td>\n","      <td>507.960175</td>\n","      <td>559.959017</td>\n","      <td>522.323511</td>\n","      <td>573.081073</td>\n","      <td>530.144772</td>\n","      <td>608.174840</td>\n","    </tr>\n","    <tr>\n","      <th>29</th>\n","      <td>ENSMUSG00000000184</td>\n","      <td>351.536620</td>\n","      <td>915.607489</td>\n","      <td>467.296232</td>\n","      <td>724.542948</td>\n","      <td>948.481301</td>\n","      <td>603.649435</td>\n","      <td>488.247835</td>\n","      <td>804.568953</td>\n","      <td>731.395917</td>\n","      <td>...</td>\n","      <td>1380.233750</td>\n","      <td>1199.935689</td>\n","      <td>1144.263772</td>\n","      <td>1211.185111</td>\n","      <td>1161.553496</td>\n","      <td>1282.170310</td>\n","      <td>1200.451420</td>\n","      <td>1300.962202</td>\n","      <td>1218.994056</td>\n","      <td>1387.911446</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 193 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-85ef8c5c-8980-4c25-9b59-8f38d1bebb8c')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-85ef8c5c-8980-4c25-9b59-8f38d1bebb8c button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-85ef8c5c-8980-4c25-9b59-8f38d1bebb8c');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-ea5973d8-736a-402f-9af8-4ecfa15ce497\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-ea5973d8-736a-402f-9af8-4ecfa15ce497')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-ea5973d8-736a-402f-9af8-4ecfa15ce497 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"rna_seq_deg"}},"metadata":{},"execution_count":18}]},{"cell_type":"code","source":["# convert gene id to gene symbol\n","# remove any genes that do not have a gene symbol\n","mg=m.mygene.MyGeneInfo()\n","ens=list(rna_seq_deg['Unnamed: 0'])\n","ginfo = mg.querymany(ens, scopes='ensembl.gene')\n","drop_list=list()\n","hit_list=list()\n","for g in ginfo:\n","    if not 'symbol' in g:\n","        drop_list.append(g['query'])\n","    else:\n","        if not g['symbol'] in hit_list:\n","            rna_seq_deg.loc[rna_seq_deg['Unnamed: 0']==g['query'], 'Unnamed: 0']=g['symbol']\n","            hit_list.append(g['symbol'])\n","\n","print('RNA-seq data shape before: ', rna_seq_deg.shape)\n","rna_seq_deg = rna_seq_deg[~rna_seq_deg['Unnamed: 0'].isin(drop_list)]\n","print('RNA-seq data shape after: ', rna_seq_deg.shape)"],"metadata":{"id":"_9rpOKBYrOJ2","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1725752638451,"user_tz":240,"elapsed":12875,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"ddf24040-7cff-431b-b892-3dfe9ba811ad"},"id":"_9rpOKBYrOJ2","execution_count":19,"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:biothings.client:querying 1-1000...\n","INFO:biothings.client:done.\n","INFO:biothings.client:querying 1001-2000...\n","INFO:biothings.client:done.\n","INFO:biothings.client:querying 2001-3000...\n","INFO:biothings.client:done.\n","INFO:biothings.client:querying 3001-3629...\n","INFO:biothings.client:done.\n","INFO:biothings.client:Finished.\n","WARNING:biothings.client:1 input query terms found dup hits:\t[('ENSMUSG00000008658', 2)]\n","INFO:biothings.client:Pass \"returnall=True\" to return complete lists of duplicate or missing query terms.\n"]},{"output_type":"stream","name":"stdout","text":["RNA-seq data shape before:  (3629, 193)\n","RNA-seq data shape after:  (3628, 193)\n"]}]},{"cell_type":"code","source":["rna_seq_deg.head()"],"metadata":{"id":"PXGHX0Bovib5","colab":{"base_uri":"https://localhost:8080/","height":273},"executionInfo":{"status":"ok","timestamp":1725752638451,"user_tz":240,"elapsed":16,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}},"outputId":"762a7ad9-39a2-4895-cb14-74cb53866ac3"},"id":"PXGHX0Bovib5","execution_count":20,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   Unnamed: 0  GSM4613909  GSM4613910   GSM4613912   GSM4613911   GSM4613913  \\\n","0       Gnai3  531.799293  666.098956   472.376024   621.176539   714.239627   \n","1       Cdc45   66.896337   47.230064   102.910370   128.290282   164.384364   \n","5        Narf  787.952006  741.983630  1168.934273   718.944340   839.863625   \n","7        Klf6  737.991790  787.752772   729.043939  1072.426562  1044.013150   \n","29      Ccnd2  351.536620  915.607489   467.296232   724.542948   948.481301   \n","\n","     GSM4613914  GSM4613915  GSM4613916  GSM4613917  ...   GSM4614091  \\\n","0    655.153477  460.846405  650.228290  663.637586  ...   304.137653   \n","1    174.525093   77.518105  136.270860  181.385240  ...    16.070776   \n","5   1075.505114  687.736010  965.843537  768.756413  ...   647.970746   \n","7    711.321620  802.769883  947.100234  795.485804  ...   578.502305   \n","29   603.649435  488.247835  804.568953  731.395917  ...  1380.233750   \n","\n","     GSM4614092   GSM4614093   GSM4614094   GSM4614095   GSM4614096  \\\n","0    308.378075   326.938171   349.489345   296.213301   299.850589   \n","1     27.652822    27.332098    18.718212    15.984246    21.458197   \n","5    673.877946   665.873120   557.745477   685.339739   642.766707   \n","7    545.142637   601.629071   672.624186   507.960175   559.959017   \n","29  1199.935689  1144.263772  1211.185111  1161.553496  1282.170310   \n","\n","     GSM4614097   GSM4614098   GSM4614099   GSM4614100  \n","0    284.772295   330.033275   339.079602   324.467550  \n","1     18.481422    30.366054    17.202049    13.987852  \n","5    485.830933   673.308761   606.485626   576.939241  \n","7    522.323511   573.081073   530.144772   608.174840  \n","29  1200.451420  1300.962202  1218.994056  1387.911446  \n","\n","[5 rows x 193 columns]"],"text/html":["\n","  <div id=\"df-e9587929-0ec1-4614-b635-08cdb2fd9c26\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>GSM4613909</th>\n","      <th>GSM4613910</th>\n","      <th>GSM4613912</th>\n","      <th>GSM4613911</th>\n","      <th>GSM4613913</th>\n","      <th>GSM4613914</th>\n","      <th>GSM4613915</th>\n","      <th>GSM4613916</th>\n","      <th>GSM4613917</th>\n","      <th>...</th>\n","      <th>GSM4614091</th>\n","      <th>GSM4614092</th>\n","      <th>GSM4614093</th>\n","      <th>GSM4614094</th>\n","      <th>GSM4614095</th>\n","      <th>GSM4614096</th>\n","      <th>GSM4614097</th>\n","      <th>GSM4614098</th>\n","      <th>GSM4614099</th>\n","      <th>GSM4614100</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Gnai3</td>\n","      <td>531.799293</td>\n","      <td>666.098956</td>\n","      <td>472.376024</td>\n","      <td>621.176539</td>\n","      <td>714.239627</td>\n","      <td>655.153477</td>\n","      <td>460.846405</td>\n","      <td>650.228290</td>\n","      <td>663.637586</td>\n","      <td>...</td>\n","      <td>304.137653</td>\n","      <td>308.378075</td>\n","      <td>326.938171</td>\n","      <td>349.489345</td>\n","      <td>296.213301</td>\n","      <td>299.850589</td>\n","      <td>284.772295</td>\n","      <td>330.033275</td>\n","      <td>339.079602</td>\n","      <td>324.467550</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Cdc45</td>\n","      <td>66.896337</td>\n","      <td>47.230064</td>\n","      <td>102.910370</td>\n","      <td>128.290282</td>\n","      <td>164.384364</td>\n","      <td>174.525093</td>\n","      <td>77.518105</td>\n","      <td>136.270860</td>\n","      <td>181.385240</td>\n","      <td>...</td>\n","      <td>16.070776</td>\n","      <td>27.652822</td>\n","      <td>27.332098</td>\n","      <td>18.718212</td>\n","      <td>15.984246</td>\n","      <td>21.458197</td>\n","      <td>18.481422</td>\n","      <td>30.366054</td>\n","      <td>17.202049</td>\n","      <td>13.987852</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Narf</td>\n","      <td>787.952006</td>\n","      <td>741.983630</td>\n","      <td>1168.934273</td>\n","      <td>718.944340</td>\n","      <td>839.863625</td>\n","      <td>1075.505114</td>\n","      <td>687.736010</td>\n","      <td>965.843537</td>\n","      <td>768.756413</td>\n","      <td>...</td>\n","      <td>647.970746</td>\n","      <td>673.877946</td>\n","      <td>665.873120</td>\n","      <td>557.745477</td>\n","      <td>685.339739</td>\n","      <td>642.766707</td>\n","      <td>485.830933</td>\n","      <td>673.308761</td>\n","      <td>606.485626</td>\n","      <td>576.939241</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Klf6</td>\n","      <td>737.991790</td>\n","      <td>787.752772</td>\n","      <td>729.043939</td>\n","      <td>1072.426562</td>\n","      <td>1044.013150</td>\n","      <td>711.321620</td>\n","      <td>802.769883</td>\n","      <td>947.100234</td>\n","      <td>795.485804</td>\n","      <td>...</td>\n","      <td>578.502305</td>\n","      <td>545.142637</td>\n","      <td>601.629071</td>\n","      <td>672.624186</td>\n","      <td>507.960175</td>\n","      <td>559.959017</td>\n","      <td>522.323511</td>\n","      <td>573.081073</td>\n","      <td>530.144772</td>\n","      <td>608.174840</td>\n","    </tr>\n","    <tr>\n","      <th>29</th>\n","      <td>Ccnd2</td>\n","      <td>351.536620</td>\n","      <td>915.607489</td>\n","      <td>467.296232</td>\n","      <td>724.542948</td>\n","      <td>948.481301</td>\n","      <td>603.649435</td>\n","      <td>488.247835</td>\n","      <td>804.568953</td>\n","      <td>731.395917</td>\n","      <td>...</td>\n","      <td>1380.233750</td>\n","      <td>1199.935689</td>\n","      <td>1144.263772</td>\n","      <td>1211.185111</td>\n","      <td>1161.553496</td>\n","      <td>1282.170310</td>\n","      <td>1200.451420</td>\n","      <td>1300.962202</td>\n","      <td>1218.994056</td>\n","      <td>1387.911446</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 193 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e9587929-0ec1-4614-b635-08cdb2fd9c26')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-e9587929-0ec1-4614-b635-08cdb2fd9c26 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-e9587929-0ec1-4614-b635-08cdb2fd9c26');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-56dbfc47-bffd-41d3-923f-70fcbdde7216\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-56dbfc47-bffd-41d3-923f-70fcbdde7216')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-56dbfc47-bffd-41d3-923f-70fcbdde7216 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"rna_seq_deg"}},"metadata":{},"execution_count":20}]},{"cell_type":"code","source":["# Export the filtered DataFrame to CSV\n","rna_seq_deg.to_csv('mnt/My Drive/Colab Notebooks/Capstone/GLDS-457_rna_seq_DEG_Normalized_Filtered_Counts.csv', index=False)"],"metadata":{"id":"mjEdLUsvrugB","executionInfo":{"status":"ok","timestamp":1725752639551,"user_tz":240,"elapsed":1114,"user":{"displayName":"Anish Kelam","userId":"07904613745596702847"}}},"id":"mjEdLUsvrugB","execution_count":21,"outputs":[]}],"metadata":{"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.0"},"colab":{"provenance":[{"file_id":"1GlIb73_SV4nulnOjA1oDUM6On66TNon0","timestamp":1725732163262},{"file_id":"1mHQqgaNjSAouku70TDmj-KMLLT4ZkDS2","timestamp":1721786269187},{"file_id":"16sf3GnBZLoH7AoXKLaVcnUpTfEi5dfPb","timestamp":1712450653875}],"collapsed_sections":["TfD_cDSmgvVg"]}},"nbformat":4,"nbformat_minor":5}
